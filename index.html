<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GANHA BRASIL - Raspa Brasil & 2 para 1000</title>

    <!-- Open Graph (Facebook, Instagram, WhatsApp) -->
    <meta property="og:title" content="GANHA BRASIL - Raspa Brasil & 2 para 1000">
    <meta property="og:description" content="Dois jogos em um só lugar! Raspadinhas virtuais e bilhetes da milhar. Ganhe até R$1.000! Pagamento seguro via Pix.">
    <meta property="og:image" content="https://raspabrasil.onrender.com/static/images/logo.jpg">
    <meta property="og:url" content="https://raspabrasil.onrender.com">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="pt_BR">
    
     <!-- Para WhatsApp e navegadores que usam Twitter Cards -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="GANHA BRASIL - Raspa Brasil & 2 para 1000">
    <meta name="twitter:description" content="Dois jogos em um só lugar! Raspadinhas virtuais e bilhetes da milhar. Ganhe até R$1.000!">
    <meta name="twitter:image" content="https://raspabrasil.onrender.com/static/images/logo.jpg">
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --primary-green: #00b341;
            --primary-yellow: #ffd700;
            --primary-blue: #003087;
            --primary-red: #dc2626;
            --success-green: #28a745;
            --affiliate-orange: #ff6b35;
            --gradient-bg: linear-gradient(135deg, #00b341 0%, #ffd700 50%, #003087 100%);
            --shadow-light: 0 4px 20px rgba(0, 0, 0, 0.1);
            --shadow-medium: 0 8px 40px rgba(0, 0, 0, 0.15);
            --shadow-heavy: 0 20px 60px rgba(0, 0, 0, 0.3);
            --border-radius: 20px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--gradient-bg);
            min-height: 100vh;
            color: #1a1a1a;
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Background Animation */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(255, 215, 0, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(0, 179, 65, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(0, 48, 135, 0.15) 0%, transparent 50%);
            animation: backgroundMove 25s ease-in-out infinite;
            z-index: -1;
        }

        @keyframes backgroundMove {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-15px) rotate(2deg); }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: rgba(255, 255, 255, 0.98);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-heavy);
            margin-top: 80px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        /* Barra Superior com Login e Botão Indique */
        .top-bar {
            position: flex;
            top: 0;
            left: 0;
            width: 100%;
            background: rgba(255, 238, 2, 0.63);
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow-light);
            z-index: 1000;
            padding: 10px 20px;
        }

        .top-bar-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
        }

        .login-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .login-info span {
            font-weight: 600;
            color: var(--primary-green);
        }

        .btn-login-top {
            background: var(--primary-green);
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .btn-login-top:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-medium);
        }

        /* Botão Indique e Ganhe - Fixo no topo */
        .indique-ganhe-btn {
            background: linear-gradient(135deg, #ff6b35, #ffd93d);
            border: none;
            border-radius: 50px;
            padding: 12px 25px;
            color: #fff;
            font-size: 16px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
            white-space: nowrap;
        }

        .indique-ganhe-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(255, 107, 107, 0.4);
        }

        /* Header Moderno */
        .header {
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(135deg, var(--primary-green), var(--primary-yellow));
            border-radius: var(--border-radius);
            margin-bottom: 40px;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(0, 179, 65, 0.8), rgba(255, 215, 0, 0.6));
            animation: wave 4s ease-in-out infinite;
        }

        @keyframes wave {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(-30px); }
        }

        .header h1 {
            font-size: clamp(2.5em, 8vw, 4em);
            font-weight: 800;
            margin-bottom: 15px;
            text-shadow: 3px 3px 15px rgba(0, 0, 0, 0.4);
            position: relative;
            z-index: 1;
        }

        .header p {
            font-size: clamp(1em, 4vw, 1.3em);
            font-weight: 500;
            opacity: 0.95;
            position: relative;
            z-index: 1;
        }

        .logo-brasil {
            margin: 0 auto 20px auto;
            position: relative;
            z-index: 1;
            display: flex;
            justify-content: center;
        }

        .logo-bandeira {
            width: clamp(60px, 15vw, 90px);
            height: clamp(60px, 15vw, 90px);
            border-radius: 50%;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            animation: pulse 3s infinite;
            border: 3px solid #ffd700;
            cursor: pointer;
            transition: var(--transition);
            background-image: url('https://pfst.cf2.poecdn.net/base/image/6334603f4a3905c7fd614b3b09aa286277d7dbe6636795bc8742d06a7e88e5b8?w=980&h=980');
            background-size: cover;
            background-position: center;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }

        .logo-bandeira:hover {
            transform: scale(1.1) rotate(10deg);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.6);
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.08) rotate(5deg); }
        }

        /* Banner Slider */
        .banner-slider {
            position: relative;
            height: clamp(250px, 40vw, 350px);
            margin-bottom: 40px;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow-heavy);
            background-image: url('https://pfst.cf2.poecdn.net/base/image/f5e5ea7363d8a169389771ca089524300491c180be4956341b918e8d3d1c474c?w=626&h=417');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(0, 179, 65, 0.8), rgba(255, 215, 0, 0.6));
            opacity: 0;
            transition: opacity 0.8s ease-in-out;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .slide.active {
            opacity: 1;
        }

        .slide-content {
            background: linear-gradient(135deg, rgba(0, 179, 65, 0.95), rgba(255, 215, 0, 0.9));
            color: white;
            padding: clamp(20px, 6vw, 40px);
            border-radius: 20px;
            text-align: center;
            backdrop-filter: blur(15px);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.4);
            border: 3px solid rgba(255, 255, 255, 0.3);
            max-width: 90%;
            animation: slideContentFloat 6s ease-in-out infinite;
        }

        @keyframes slideContentFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-8px); }
        }

        .slide-content h1 {
            font-size: clamp(2em, 7vw, 4em);
            font-weight: 800;
            margin-bottom: 15px;
            text-shadow: 3px 3px 15px rgba(0, 0, 0, 0.5);
        }

        .slide-content p {
            font-size: clamp(1em, 4vw, 1.4em);
            font-weight: 600;
            opacity: 0.95;
        }

        /* Seleção de Jogos - Lado a Lado */
        .game-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin: 40px 0;
        }

        .game-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 249, 250, 0.95));
            padding: clamp(30px, 6vw, 50px);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-medium);
            backdrop-filter: blur(15px);
            border: 3px solid transparent;
            transition: var(--transition);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .game-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-heavy);
            border-color: var(--primary-green);
        }

        .game-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: shimmer 3s infinite;
            pointer-events: none;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .game-icon {
            font-size: clamp(3em, 8vw, 5em);
            margin-bottom: 20px;
            background: linear-gradient(135deg, var(--primary-green), var(--primary-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .game-title {
            font-size: clamp(1.8em, 5vw, 2.5em);
            font-weight: 800;
            margin-bottom: 15px;
            color: var(--primary-green);
        }

        .game-description {
            font-size: clamp(1em, 3.5vw, 1.2em);
            color: #555;
            margin-bottom: 25px;
            font-weight: 600;
        }

        .game-features {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            margin: 25px 0;
            text-align: left;
        }

        .game-feature {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 0;
            font-weight: 600;
            color: #333;
        }

        .game-feature i {
            color: var(--success-green);
            font-size: 1.2em;
        }

        /* Botões Modernos */
        .btn {
            padding: clamp(14px, 4vw, 18px) clamp(28px, 6vw, 36px);
            border: none;
            border-radius: 15px;
            font-size: clamp(14px, 4vw, 17px);
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 1px;
            width: 100%;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: var(--transition);
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-green), #00a538);
            color: white;
            box-shadow: var(--shadow-medium);
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-4px);
            box-shadow: var(--shadow-heavy);
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--primary-yellow), #ffcc00);
            color: #333;
            box-shadow: var(--shadow-medium);
        }

        .btn-secondary:hover:not(:disabled) {
            transform: translateY(-4px);
            box-shadow: var(--shadow-heavy);
        }

        .btn-cta {
            background: linear-gradient(135deg, var(--success-green), #1e7e34);
            color: white;
            font-size: clamp(18px, 5vw, 22px);
            padding: clamp(18px, 5vw, 22px) clamp(36px, 8vw, 45px);
            animation: ctaPulse 2s ease-in-out infinite;
            box-shadow: 0 0 30px rgba(40, 167, 69, 0.6);
        }

        @keyframes ctaPulse {
            0% { 
                transform: scale(1);
                box-shadow: 0 0 30px rgba(40, 167, 69, 0.6);
            }
            50% { 
                transform: scale(1.05);
                box-shadow: 0 0 50px rgba(40, 167, 69, 0.9);
            }
            100% { 
                transform: scale(1);
                box-shadow: 0 0 30px rgba(40, 167, 69, 0.6);
            }
        }

        /* WhatsApp Flutuante */
        .whatsapp-float {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 20px rgba(37, 211, 102, 0.4);
            z-index: 9998;
            cursor: pointer;
            text-decoration: none;
            font-size: 24px;
            transition: all 0.3s ease;
            animation: pulseWhatsApp 2s infinite;
        }

        .whatsapp-float:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 30px rgba(37, 211, 102, 0.6);
            color: white;
        }

        @keyframes pulseWhatsApp {
            0% { box-shadow: 0 4px 20px rgba(37, 211, 102, 0.4); }
            50% { box-shadow: 0 6px 30px rgba(37, 211, 102, 0.6); }
            100% { box-shadow: 0 4px 20px rgba(37, 211, 102, 0.4); }
        }

        /* Seção Principal */
        .main-section {
            text-align: center;
            margin-bottom: 50px;
            padding: 0 15px;
        }

        .main-section h2 {
            font-size: clamp(2em, 6vw, 3em);
            font-weight: 800;
            margin-bottom: 20px;
            background: linear-gradient(135deg, var(--primary-green), var(--primary-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .main-section .subtitle {
            font-size: clamp(1.1em, 4vw, 1.4em);
            color: #555;
            margin-bottom: 30px;
            font-weight: 600;
        }

        /* CTA Message */
        .cta-message {
            background: linear-gradient(135deg, var(--primary-green), #f8f536ff);
            color: white;
            padding: clamp(20px, 5vw, 30px);
            border-radius: var(--border-radius);
            margin: 30px 0;
            text-align: center;
            box-shadow: var(--shadow-medium);
            position: relative;
            overflow: hidden;
        }

        .cta-message.success {
            background: linear-gradient(135deg, var(--success-green), #1e7e34);
        }

        .cta-message.warning {
            background: linear-gradient(135deg, #ff9800, #f57c00);
        }

        .cta-message::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: shimmer 3s infinite;
        }

        .cta-message h3 {
            font-size: clamp(1.3em, 5vw, 1.8em);
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
        }

        .cta-message p {
            position: relative;
            z-index: 1;
        }

        .urgency-indicator {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: rgba(255, 255, 255, 0.25);
            padding: 12px 20px;
            border-radius: 25px;
            font-weight: 700;
            margin-top: 15px;
            position: relative;
            z-index: 1;
        }

        /* Winners Slider */
        .winners-slider {
            background: linear-gradient(135deg, #f0f9f0, #e8f5e8);
            padding: clamp(25px, 6vw, 40px);
            border-radius: var(--border-radius);
            margin: 40px 0;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-medium);
            border: 3px solid #28a745;
        }

        .winners-container {
            display: flex;
            gap: 20px;
            animation: scrollLeft 45s linear infinite;
            width: max-content;
        }

        .winners-container:hover {
            animation-play-state: paused;
        }

        @keyframes scrollLeft {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }

        .winner-item {
            min-width: 280px;
            background: white;
            padding: clamp(20px, 5vw, 25px);
            border-radius: 15px;
            box-shadow: var(--shadow-light);
            text-align: center;
            flex-shrink: 0;
            border: 2px solid #28a745;
            position: relative;
        }

        .winner-name {
            font-size: clamp(1.1em, 3.5vw, 1.3em);
            font-weight: 800;
            color: #1a1a1a;
            margin-bottom: 8px;
        }

        .winner-prize {
            font-size: clamp(1.3em, 4vw, 1.6em);
            font-weight: 900;
            color: #28a745;
            margin-bottom: 8px;
        }

        .winner-time {
            font-size: clamp(0.85em, 3vw, 1em);
            color: #666;
            font-weight: 600;
        }

        /* Promoção 10+2 */
        .promocao-bonus {
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            color: white;
            padding: clamp(15px, 4vw, 20px);
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
            box-shadow: var(--shadow-medium);
            font-weight: 700;
            display: none;
        }

        .promocao-bonus.ativa {
            display: block;
            animation: pulseGlow 1.5s ease-in-out infinite;
        }

        @keyframes pulseGlow {
            0% { 
                box-shadow: 0 0 20px rgba(255, 107, 53, 0.8);
                transform: scale(1);
            }
            50% { 
                box-shadow: 0 0 30px rgba(255, 107, 53, 0.9);
                transform: scale(1.02);
            }
            100% { 
                box-shadow: 0 0 20px rgba(255, 107, 53, 0.8);
                transform: scale(1);
            }
        }

        /* Quantidade Selector */
        .quantidade-selector {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: clamp(20px, 6vw, 30px);
            margin: 40px auto;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 249, 250, 0.95));
            padding: clamp(25px, 6vw, 35px);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-medium);
            backdrop-filter: blur(10px);
            max-width: 90%;
        }

        .quantidade-btn {
            width: clamp(50px, 14vw, 70px);
            height: clamp(50px, 14vw, 70px);
            border: none;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-green), #00a538);
            color: white;
            font-size: clamp(24px, 6vw, 32px);
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow-light);
        }

        .quantidade-btn:hover {
            transform: scale(1.15);
            box-shadow: var(--shadow-heavy);
        }

        .quantidade-display {
            font-size: clamp(3em, 10vw, 5em);
            font-weight: 900;
            color: var(--primary-green);
            min-width: clamp(80px, 20vw, 120px);
            text-align: center;
            background: linear-gradient(135deg, var(--primary-green), var(--primary-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .total-display {
            text-align: center;
            font-size: clamp(1.8em, 7vw, 2.8em);
            font-weight: 800;
            color: var(--primary-blue);
            margin: 30px auto;
            padding: clamp(20px, 5vw, 30px);
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 249, 250, 0.95));
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-medium);
            backdrop-filter: blur(10px);
            max-width: 90%;
        }

        /* Informações de segurança */
        .security-info {
            margin-top: 20px;
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            align-items: center;
            justify-content: center;
            max-width: 900px;
            margin-left: auto;
            margin-right: auto;
        }

        .security-item {
            font-size: clamp(0.9em, 3.5vw, 1.1em);
            color: #666;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-weight: 600;
            background: rgba(255, 255, 255, 0.9);
            padding: 15px 20px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border: 2px solid rgba(40, 167, 69, 0.2);
            text-align: center;
        }

        .security-item i {
            color: var(--success-green);
            font-size: 1.2em;
        }

        /* Raspadinha Page */
        .raspadinha-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 400px;
            background: linear-gradient(135deg, #0d1b0d, #1a2e1a);
            color: white;
            border-radius: var(--border-radius);
            margin: 20px auto;
            padding: 20px;
            width: 100%;
            max-width: min(380px, 95vw);
            box-shadow: var(--shadow-heavy);
            border: 3px solid #ffd700;
            position: relative;
        }

        .raspadinha-content {
            text-align: center;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .raspadinha-titulo {
            margin-bottom: 30px;
            font-size: clamp(1.2em, 4vw, 1.8em);
            font-weight: 700;
            text-shadow: 2px 2px 10px rgba(0, 0, 0, 0.5);
        }

        .raspadinha {
            position: relative;
            width: min(300px, 85vw);
            height: min(180px, 51vw);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0,0,0,0.6);
            margin: 0 auto;
            border: 2px solid #ffd700;
            cursor: pointer;
        }

        .premio {
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, #28a745, #20c997);
            color: #fff;
            font-size: clamp(20px, 6vw, 26px);
            font-weight: bold;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            flex-direction: column;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.5);
            letter-spacing: 1px;
        }

        .raspadinha canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .raspadinha-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: clamp(20px, 5vw, 40px);
            margin: 50px auto;
            padding: clamp(20px, 5vw, 30px);
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.6), rgba(248, 249, 250, 0.6));
            border-radius: var(--border-radius);
            backdrop-filter: blur(15px);
            width: 100%;
            max-width: 95vw;
            justify-items: center;
        }

        /* Área de Login/Cadastro */
        .login-container {
            max-width: 400px;
            margin: 0 auto;
            background: white;
            padding: clamp(25px, 6vw, 40px);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-medium);
        }

        .login-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
        }

        .login-tab {
            flex: 1;
            padding: 12px;
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            text-align: center;
        }

        .login-tab.active {
            background: var(--primary-green);
            color: white;
            border-color: var(--primary-green);
        }

        /* Área do Cliente */
        .cliente-info {
            background: linear-gradient(135deg, #f8f9fa, white);
            padding: clamp(25px, 6vw, 40px);
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            box-shadow: var(--shadow-light);
            border: 2px solid var(--primary-green);
        }

        .cliente-info h3 {
            color: var(--primary-green);
            margin-bottom: 15px;
            font-size: clamp(1.5em, 4vw, 2em);
        }

        .cliente-info p {
            font-size: clamp(1em, 3.5vw, 1.2em);
            color: #333;
            margin: 5px 0;
        }

        /* Minhas Raspadinhas */
        .minhas-raspadinhas-container {
            margin: 30px 0;
        }

        .raspadinha-item {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-light);
            border: 2px solid #28a745;
        }

        .raspadinha-item.disponivel {
            border-color: #28a745;
            background: linear-gradient(135deg, #f0f9f0, white);
        }

        .raspadinha-item.raspada {
            border-color: #6c757d;
            background: #f8f9fa;
        }

        .raspadinha-item.premiada {
            border-color: #ffd700;
            background: linear-gradient(135deg, #fff9e6, white);
            animation: pulseGlow 2s infinite;
        }

        /* Meus Bilhetes */
        .meus-bilhetes-container {
            margin: 30px 0;
        }

        .bilhete-item {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-light);
            border: 2px solid #007bff;
        }

        .bilhete-numero {
            text-align: center;
            font-size: clamp(2em, 8vw, 3em);
            font-weight: 900;
            color: var(--primary-blue);
            margin: 10px 0;
            padding: 15px;
            background: linear-gradient(135deg, #e6f2ff, #f0f8ff);
            border-radius: 10px;
        }

        /* Bilhete Digital */
        .bilhete-container {
            background: linear-gradient(135deg, #f8f9fa, white);
            padding: clamp(25px, 6vw, 40px);
            border-radius: var(--border-radius);
            margin: 30px 0;
            box-shadow: var(--shadow-medium);
            border: 3px solid var(--primary-green);
        }

        .bilhete-digital {
            background: white;
            border: 2px dashed var(--primary-green);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: var(--shadow-light);
        }

        .milhar-sorteada {
            text-align: center;
            font-size: clamp(3em, 10vw, 5em);
            font-weight: 900;
            color: var(--primary-green);
            margin: 20px 0;
            padding: 20px;
            background: white;
            border-radius: 15px;
            box-shadow: var(--shadow-light);
            border: 2px solid #28a745;
        }

        .premio-acumulado {
            text-align: center;
            font-size: clamp(2em, 8vw, 3.5em);
            font-weight: 800;
            color: #dc2626;
            margin: 20px 0;
            padding: 20px;
            background: linear-gradient(135deg, #fff5f5, #fee);
            border-radius: 15px;
            box-shadow: var(--shadow-light);
            border: 2px solid #dc2626;
        }

        .resultado-section {
            background: linear-gradient(135deg, #f0f9f0, #e8f5e8);
            padding: clamp(25px, 6vw, 40px);
            border-radius: var(--border-radius);
            margin: 40px 0;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-medium);
            border: 3px solid #28a745;
        }

        .resultado-title {
            text-align: center;
            font-size: clamp(1.8em, 6vw, 2.5em);
            color: #28a745;
            font-weight: 800;
            margin-bottom: 30px;
        }

        /* Affiliate Styles */
        .affiliate-section {
            background: linear-gradient(135deg, var(--primary-yellow), #ffcc00);
            padding: clamp(30px, 6vw, 50px);
            border-radius: var(--border-radius);
            margin: 40px 0;
            box-shadow: var(--shadow-medium);
            color: #1a1a1a;
        }

        .affiliate-link-display {
            background: white;
            border: 3px solid var(--affiliate-orange);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
            word-break: break-all;
            font-family: monospace;
            font-size: clamp(12px, 3vw, 14px);
            color: var(--affiliate-orange);
            font-weight: 700;
        }

        .affiliate-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .affiliate-stat-item {
            background: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            border: 2px solid var(--affiliate-orange);
            box-shadow: var(--shadow-light);
        }

        .affiliate-stat-number {
            font-size: clamp(1.8em, 5vw, 2.5em);
            font-weight: 900;
            color: var(--affiliate-orange);
            display: block;
        }

        .affiliate-stat-label {
            font-size: clamp(0.9em, 3vw, 1.1em);
            color: #666;
            font-weight: 600;
        }

        /* Payment Page */
        .payment-container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: clamp(25px, 6vw, 40px);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-medium);
        }

        .qr-container {
            background: linear-gradient(135deg, #f8f9fa, white);
            padding: clamp(25px, 6vw, 40px);
            border-radius: var(--border-radius);
            text-align: center;
            margin: 30px 0;
            box-shadow: var(--shadow-light);
        }

        .qr-code img {
            max-width: min(200px, 70vw);
            max-height: min(200px, 70vw);
            width: auto;
            height: auto;
            border: 3px solid var(--primary-green);
            border-radius: 12px;
            box-shadow: var(--shadow-medium);
        }

        .pix-code {
            background: #f8f9fa;
            padding: clamp(15px, 4vw, 20px);
            border-radius: 12px;
            margin: 25px 0;
            word-break: break-all;
            font-family: 'Courier New', monospace;
            font-size: clamp(11px, 3vw, 14px);
            border: 2px dashed var(--primary-green);
            color: #1a1a1a;
            font-weight: 600;
            line-height: 1.4;
            max-height: 120px;
            overflow-y: auto;
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 700;
            color: #333;
            font-size: clamp(14px, 3.5vw, 16px);
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: clamp(14px, 4vw, 18px);
            border: 3px solid #ddd;
            border-radius: 12px;
            font-size: clamp(16px, 4vw, 18px);
            transition: var(--transition);
            background: white;
        }

        .form-group input:focus,
        .form-group select:focus {
            border-color: var(--primary-green);
            outline: none;
            box-shadow: 0 0 0 4px rgba(0, 179, 65, 0.15);
        }

        /* Admin Modal */
        .admin-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            backdrop-filter: blur(8px);
        }

        .admin-modal-content {
            background: white;
            padding: clamp(25px, 6vw, 40px);
            border-radius: var(--border-radius);
            max-width: 1200px;
            width: 95%;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: var(--shadow-heavy);
        }

        /* Admin Tabs */
        .admin-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .admin-tab {
            padding: 12px 20px;
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            font-size: clamp(12px, 3vw, 14px);
        }

        .admin-tab.active {
            background: var(--primary-green);
            color: white;
            border-color: var(--primary-green);
        }

        .admin-tab-content {
            display: none;
        }

        .admin-tab-content.active {
            display: block;
        }

        /* Status Bar */
        .status-bar {
            background: linear-gradient(90deg, var(--primary-green), var(--primary-yellow));
            padding: clamp(15px, 4vw, 20px);
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            color: white;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
        }

        .status-item {
            text-align: center;
            padding: 10px;
        }

        .status-item .number {
            font-size: clamp(1.5em, 5vw, 2em);
            font-weight: 800;
            display: block;
        }

        .status-item .label {
            font-size: clamp(0.8em, 3vw, 1em);
            opacity: 0.9;
        }

        /* Loading Animation */
        .loading {
            text-align: center;
            padding: 50px;
        }

        .loading::after {
            content: '';
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--primary-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Winner Alert Modal */
        .winner-alert {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            backdrop-filter: blur(5px);
        }

        .winner-alert-content {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: clamp(30px, 8vw, 50px);
            border-radius: 25px;
            text-align: center;
            box-shadow: 0 25px 80px rgba(40, 167, 69, 0.9);
            border: 4px solid #ffd700;
            max-width: 90%;
            position: relative;
            overflow: hidden;
            animation: winnerPulse 1s ease-in-out;
        }

        @keyframes winnerPulse {
            0% { 
                transform: scale(0.8);
                opacity: 0;
            }
            50% { 
                transform: scale(1.05);
            }
            100% { 
                transform: scale(1);
                opacity: 1;
            }
        }

        .winner-alert h2 {
            font-size: clamp(1.8em, 6vw, 2.5em);
            margin: 30px 0 20px 0;
            text-shadow: 2px 2px 10px rgba(0, 0, 0, 0.5);
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .winner-alert p {
            font-size: clamp(1.1em, 4vw, 1.4em);
            margin-bottom: 15px;
            font-weight: 600;
        }

        .winner-alert .close-btn {
            background: #ffd700;
            color: #1a1a1a;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: clamp(1em, 4vw, 1.2em);
            font-weight: 700;
            cursor: pointer;
            margin-top: 20px;
            transition: var(--transition);
            text-transform: uppercase;
            animation: pulseGlow 0.8s infinite;
        }

        .winner-alert .close-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.5);
        }

        /* Modal personalizado */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            backdrop-filter: blur(8px);
        }

        .modal-content {
            background: white;
            padding: clamp(25px, 6vw, 40px);
            border-radius: var(--border-radius);
            max-width: 500px;
            width: 90%;
            text-align: center;
            box-shadow: var(--shadow-heavy);
        }

        /* WhatsApp Button */
        .whatsapp-btn {
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
            padding: clamp(16px, 4vw, 20px) clamp(32px, 6vw, 40px);
            border: none;
            border-radius: 15px;
            font-size: clamp(16px, 4vw, 20px);
            font-weight: 700;
            cursor: pointer;
            width: 100%;
            margin-top: 25px;
            transition: var(--transition);
            box-shadow: var(--shadow-medium);
        }

        .whatsapp-btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-heavy);
        }

        /* Utility Classes */
        .page {
            display: none;
            animation: fadeIn 0.6s ease-in-out;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                margin-top: 120px;
                padding: 15px;
            }

            .top-bar-content {
                flex-direction: column;
                gap: 10px;
            }

            .indique-ganhe-btn {
                font-size: 14px;
                padding: 10px 20px;
            }

            .winners-slider {
                padding: 20px 15px;
            }

            .quantidade-selector {
                flex-direction: row;
                flex-wrap: wrap;
                gap: 20px;
                padding: 25px 15px;
            }

            .status-bar {
                grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
                gap: 10px;
            }

            .security-info {
                grid-template-columns: 1fr;
                gap: 12px;
                margin-top: 15px;
            }

            .game-selection {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .admin-tabs {
                flex-direction: column;
                gap: 8px;
            }

            .admin-tab {
                text-align: center;
                padding: 10px 15px;
            }
        }

        @media (max-width: 480px) {
            .container {
                margin-top: 100px;
                padding: 10px;
            }

            .banner-slider {
                height: clamp(200px, 50vw, 300px);
            }

            .slide-content {
                padding: 20px 15px;
                max-width: 95%;
            }

            .indique-ganhe-btn {
                font-size: 12px;
                padding: 8px 15px;
            }

            .quantidade-selector {
                gap: 15px;
                padding: 20px 10px;
            }

            .total-display {
                font-size: clamp(1.5em, 6vw, 2.2em);
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <!-- Barra Superior com Login e Botão Indique -->
    <div class="top-bar">
        <div class="top-bar-content">
            <div class="login-info" id="login-info">
                <span id="cliente-nome-display" style="display: none;">Olá, <strong></strong>!</span>
                <button class="btn-login-top" id="btn-login-top" onclick="mostrarLogin()">
                    <i class="fas fa-user"></i> Entrar
                </button>
                <button class="btn-login-top" id="btn-logout-top" onclick="logoutCliente()" style="display: none;">
                    <i class="fas fa-sign-out-alt"></i> Sair
                </button>
            </div>
            <button class="indique-ganhe-btn" onclick="abrirAfiliados()">
                INDIQUE E GANHE
            </button>
        </div>
    </div>

    <!-- Botão WhatsApp Flutuante -->
    <a href="https://wa.me/5582996092684?text=Olá!%20Preciso%20de%20suporte." target="_blank" class="whatsapp-float" title="Suporte WhatsApp">
        <i class="fab fa-whatsapp"></i>
    </a>

    <div class="container">
        <!-- Página de Login/Cadastro -->
        <div id="login-page" class="page">
            <div class="login-container">
                <div class="login-tabs">
                    <div class="login-tab active" onclick="trocarAbaLogin('login')">Entrar</div>
                    <div class="login-tab" onclick="trocarAbaLogin('cadastro')">Cadastrar</div>
                </div>

                <!-- Login -->
                <div id="login-form" class="login-form-content active">
                    <h3 style="margin-bottom: 25px; color: var(--primary-green);">Faça seu Login</h3>
                    <div class="form-group">
                        <label>CPF:</label>
                        <input type="text" id="login-cpf" placeholder="000.000.000-00" maxlength="14" oninput="mascaraCPF(this)">
                    </div>
                    <button class="btn btn-primary" onclick="fazerLogin()">
                        Entrar
                    </button>
                    <div id="login-message" style="margin-top: 20px;"></div>
                </div>

                <!-- Cadastro -->
                <div id="cadastro-form" class="login-form-content" style="display: none;">
                    <h3 style="margin-bottom: 25px; color: var(--primary-green);">Crie sua Conta</h3>
                    <div class="form-group">
                        <label>Nome Completo:</label>
                        <input type="text" id="cadastro-nome" placeholder="Digite seu nome completo">
                    </div>
                    <div class="form-group">
                        <label>CPF:</label>
                        <input type="text" id="cadastro-cpf" placeholder="000.000.000-00" maxlength="14" oninput="mascaraCPF(this)">
                    </div>
                    <div class="form-group">
                        <label>Telefone (opcional):</label>
                        <input type="tel" id="cadastro-telefone" placeholder="(11) 99999-9999">
                    </div>
                    <div class="form-group">
                        <label>E-mail (opcional):</label>
                        <input type="email" id="cadastro-email" placeholder="seu@email.com">
                    </div>
                    <button class="btn btn-primary" onclick="fazerCadastro()">
                        Criar Conta
                    </button>
                    <div id="cadastro-message" style="margin-top: 20px;"></div>
                </div>

                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn btn-secondary" onclick="voltarSelecaoJogos()">
                        Voltar aos Jogos
                    </button>
                </div>
            </div>
        </div>

        <!-- Página de Seleção de Jogos -->
        <div id="game-selection-page" class="page active">
            <!-- Banner Slider -->
            <div class="banner-slider">
                <div class="slide active">
                    <div class="slide-content">
                        <div class="logo-brasil">
                            <div class="logo-bandeira" onclick="abrirAdmin()" title="">
                            </div>
                        </div>
                        <h1>GANHA BRASIL</h1>
                        <p>Escolha seu jogo e ganhe até R$ 1.000!</p>
                    </div>
                </div>
                <div class="slide">
                    <div class="slide-content">
                        <div class="logo-brasil">
                            <div class="logo-bandeira" onclick="abrirAdmin()" title="">
                            </div>
                        </div>
                        <h1>GANHA BRASIL</h1>
                        <p>Raspadinhas e Bilhetes da Sorte!</p>
                    </div>
                </div>
                <div class="slide">
                    <div class="slide-content">
                        <div class="logo-brasil">
                            <div class="logo-bandeira" onclick="abrirAdmin()" title="">
                            </div>
                        </div>
                        <h1>GANHA BRASIL</h1>
                        <p>Sistema 100% Seguro!</p>
                    </div>
                </div>
            </div>

            <!-- CTA Message -->
            <div class="cta-message">
                <h3>DOIS JOGOS EM UM SÓ LUGAR!</h3>
                <p>Escolha entre <strong>Raspadinhas Virtuais</strong> ou <strong>Bilhetes da Milhar</strong> e ganhe até R$ 1.000!</p>
            </div>

            <div class="main-section">
                <h2>Escolha seu Jogo da Sorte!</h2>
                <p class="subtitle">Dois jogos incríveis para você ganhar</p>
                
                <div class="game-selection">
                    <!-- Raspa Brasil -->
                    <div class="game-card">
                        <div class="game-icon">
                            <i class="fas fa-coins"></i>
                        </div>
                        <h3 class="game-title">RASPA BRASIL</h3>
                        <p class="game-description">A raspadinha virtual mais famosa do Brasil!</p>
                        
                        <div class="game-features">
                            <div class="game-feature">
                                <i class="fas fa-money-bill-wave"></i>
                                <span>Cada raspadinha custa R$ 1,00</span>
                            </div>
                            <div class="game-feature">
                                <i class="fas fa-trophy"></i>
                                <span>Ganhe de R$ 1,00 até R$ 1.000</span>
                            </div>
                            <div class="game-feature">
                                <i class="fas fa-gift"></i>
                                <span>Promoção: 10 + 2 grátis</span>
                            </div>
                            <div class="game-feature">
                                <i class="fas fa-bolt"></i>
                                <span>Resultado na hora</span>
                            </div>
                        </div>
                        
                        <button class="btn btn-primary" onclick="irParaRaspaBrasil()">
                            JOGAR RASPA BRASIL
                        </button>
                    </div>
                    
                    <!-- 2 para 1000 -->
                    <div class="game-card">
                        <div class="game-icon">
                            <i class="fas fa-ticket-alt"></i>
                        </div>
                        <h3 class="game-title">2 PARA 1000</h3>
                        <p class="game-description">Bilhetes da milhar com sorteio diário!</p>
                        
                        <div class="game-features">
                            <div class="game-feature">
                                <i class="fas fa-money-bill-wave"></i>
                                <span>Cada bilhete custa R$ 2,00</span>
                            </div>
                            <div class="game-feature">
                                <i class="fas fa-trophy"></i>
                                <span>Prêmio de até R$ 1.000</span>
                            </div>
                            <div class="game-feature">
                                <i class="fas fa-clock"></i>
                                <span>Sorteio diário às 18h</span>
                            </div>
                            <div class="game-feature">
                                <i class="fas fa-chart-line"></i>
                                <span>Prêmio acumula se não houver ganhador</span>
                            </div>
                        </div>
                        
                        <button class="btn btn-secondary" onclick="irPara2Para1000()">
                            JOGAR 2 PARA 1000
                        </button>
                    </div>
                </div>

                <div class="security-info">
                    <div class="security-item">
                        <i class="fas fa-shield-alt"></i>
                        <span>Pagamento 100% seguro</span>
                    </div>
                    <div class="security-item">
                        <i class="fas fa-clock"></i>
                        <span>Prêmios pagos em até 24h</span>
                    </div>
                    <div class="security-item">
                        <i class="fas fa-trophy"></i>
                        <span>Sistema antifraude</span>
                    </div>
                </div>
            </div>

            <!-- Winners Slider -->
            <div class="winners-slider">
                <h3 style="text-align: center; margin-bottom: 30px; font-size: clamp(1.8em, 6vw, 2.5em); color: #28a745; font-weight: 800;">Ganhadores Recentes:</h3>
                <div class="winners-container" id="winners-container">
                    <!-- Será preenchido dinamicamente -->
                </div>
            </div>
        </div>

        <!-- RASPA BRASIL PAGES -->
        <div id="raspa-brasil-home" class="page">
            <!-- Header -->
            <div class="header">
                <div class="logo-brasil">
                    <div class="logo-bandeira" onclick="abrirAdmin()" title="">
                    </div>
                </div>
                <h1>RASPA BRASIL</h1>
                <p>A Melhor Raspadinha Virtual do Brasil!</p>
            </div>

            <!-- Botão Minhas Raspadinhas -->
            <div style="text-align: center; margin-bottom: 30px;">
                <button class="btn btn-secondary" onclick="mostrarMinhasRaspadinhas()">
                    <i class="fas fa-list"></i> MINHAS RASPADINHAS
                </button>
            </div>

            <!-- CTA Message -->
            <div class="cta-message">
                <h3>RASPADINHAS LIMITADAS!</h3>
                <p>Poucas <strong>raspadinhas disponíveis</strong> - Ganhe de R$ 1,00 até R$ 1000!</p>
                <div class="urgency-indicator">
                    Corre que ainda dá tempo!
                </div>
            </div>

            <div class="main-section">
                <h2>Ganhe de R$ 1,00 até R$ 1.000,00!</h2>
                <p class="subtitle">Cada raspadinha custa apenas <strong>R$ 1,00</strong></p>
                
                <div class="quantidade-selector">
                    <button class="quantidade-btn" onclick="diminuirQuantidadeRB()">
                        -
                    </button>
                    <div id="quantidade-display-rb" class="quantidade-display">1</div>
                    <button class="quantidade-btn" onclick="aumentarQuantidadeRB()">
                        +
                    </button>
                </div>

                <!-- Promoção 10+2 -->
                <div id="promocao-bonus-rb" class="promocao-bonus">
                    <h3>PROMOÇÃO ESPECIAL!</h3>
                    <p>Comprando 10 raspadinhas você ganha mais <strong>2 GRÁTIS!</strong></p>
                    <p>Total: <strong>12 raspadinhas</strong> por R$ 10,00</p>
                </div>
                
                <div id="total-display-rb" class="total-display">
                    Total: R$ 1,00
                </div>
                
                <button class="btn btn-cta" onclick="irParaPagamentoRB()">
                    COMPRAR AGORA
                </button>

                <div class="security-info">
                    <div class="security-item">
                        <span>Pagamento 100% seguro</span>
                    </div>
                    <div class="security-item">
                        <span>Prêmios pagos na hora</span>
                    </div>
                    <div class="security-item">
                        <span>Sistema antifraude</span>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn btn-secondary" onclick="voltarSelecaoJogos()">
                        Voltar aos Jogos
                    </button>
                </div>
            </div>

            <!-- Ganhadores das últimas horas -->
            <div class="winners-slider">
                <h3 style="text-align: center; margin-bottom: 30px; font-size: clamp(1.8em, 6vw, 2.5em); color: #28a745; font-weight: 800;">Ganhadores das últimas horas:</h3>
                <div class="winners-container" id="winners-container-rb">
                    <!-- Será preenchido dinamicamente -->
                </div>
            </div>
        </div>

        <!-- Página Minhas Raspadinhas -->
        <div id="minhas-raspadinhas-page" class="page">
            <div class="header">
                <div class="logo-brasil">
                    <div class="logo-bandeira"></div>
                </div>
                <h1>MINHAS RASPADINHAS</h1>
                <p>Gerencie suas raspadinhas</p>
            </div>

            <div class="cliente-info" id="cliente-info-raspadinhas">
                <h3>Bem-vindo(a)!</h3>
                <p>Faça login para ver suas raspadinhas</p>
            </div>

            <div class="minhas-raspadinhas-container" id="minhas-raspadinhas-container">
                <div class="loading">
                    <p>Carregando suas raspadinhas...</p>
                </div>
            </div>

            <div style="text-align: center; margin-top: 30px;">
                <button class="btn btn-secondary" onclick="voltarRaspaBrasil()">
                    Voltar
                </button>
            </div>
        </div>

        <!-- Página de Pagamento Raspa Brasil -->
        <div id="raspa-brasil-payment" class="page">
            <div class="header">
                <div class="logo-brasil">
                    <div class="logo-bandeira"></div>
                </div>
                <h1>RASPA BRASIL</h1>
                <p>Finalize seu pagamento</p>
            </div>

            <div class="payment-container">
                <div style="text-align: center; margin-bottom: 40px;">
                    <h2 style="color: #1a1a1a;">Pagamento via PIX</h2>
                    <p style="font-size: clamp(1.1em, 4vw, 1.3em); margin: 15px 0; font-weight: 600; color: #1a1a1a;">
                        Quantidade: <strong><span id="quantidade-pagamento-rb">1</span> raspadinha(s)</strong>
                    </p>
                    <div style="background: linear-gradient(135deg, #00b341, #003087); color: white; padding: clamp(15px, 4vw, 25px); border-radius: 15px; font-size: clamp(1.3em, 5vw, 1.8em); font-weight: 800; box-shadow: 0 8px 25px rgba(0,0,0,0.2);">
                        Total: R$ <span id="total-pagamento-rb">1,00</span>
                    </div>
                </div>

                <div id="payment-status-rb">
                    <div class="loading">
                        <p style="font-size: clamp(1.1em, 4vw, 1.3em); margin-bottom: 25px; font-weight: 600; color: #1a1a1a;">Gerando seu QR Code PIX...</p>
                    </div>
                </div>

                <div class="qr-container" id="qr-section-rb" style="display: none;">
                    <h3 style="color: #1a1a1a;">Escaneie o QR Code</h3>
                    <div id="qr-code-rb" class="qr-code"></div>
                    
                    <div style="margin: 25px 0;">
                        <p style="font-weight: 700; margin-bottom: 15px; font-size: clamp(1em, 3.5vw, 1.2em); color: #1a1a1a;">
                            Ou copie o código PIX:
                        </p>
                        <div class="pix-code" id="pix-code-rb"></div>
                        <button class="btn btn-secondary" onclick="copiarCodigoPixRB()">
                            Copiar Código PIX
                        </button>
                    </div>

                    <div id="payment-actions-rb">
                        <button class="btn btn-primary" onclick="criarPagamentoRealRB()" style="width: 100%; margin-top: 25px;" id="btn-real-payment-rb">
                            Pagar com PIX
                        </button>
                    </div>
                </div>

                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn btn-secondary" onclick="voltarRaspaBrasil()">
                        Voltar
                    </button>
                </div>
            </div>
        </div>

        <!-- Página de Raspadinhas -->
        <div id="raspa-brasil-game" class="page">
            <div class="header">
                <div class="logo-brasil">
                    <div class="logo-bandeira"></div>
                </div>
                <h1>RASPA BRASIL</h1>
                <p>Suas raspadinhas estão prontas!</p>
            </div>

            <div style="text-align: center; margin-bottom: 50px;">
                <h2 style="font-size: clamp(2em, 7vw, 3em); color: #00b341; font-weight: 800;">
                    Raspe suas raspadinhas!
                </h2>
                <p style="font-size: clamp(1.2em, 5vw, 1.5em); margin: 20px 0; font-weight: 600;">
                    Clique na raspadinha para começar
                </p>
                <div class="cta-message success" style="margin: 25px auto; max-width: 600px;">
                    <h3>Boa sorte!</h3>
                    <p>Raspe e descubra se você ganhou!</p>
                </div>
            </div>

            <div class="raspadinha-grid" id="raspadinha-grid-rb">
                <!-- Raspadinhas serão geradas dinamicamente -->
            </div>

            <div id="premio-container-rb" style="display: none;"></div>

            <div style="text-align: center; margin-top: 50px;">
                <button class="btn btn-secondary" onclick="voltarSelecaoJogos()">
                    Voltar aos Jogos
                </button>
            </div>
        </div>

        <!-- 2 PARA 1000 PAGES -->
        <div id="2para1000-home" class="page">
            <!-- Header -->
            <div class="header">
                <div class="logo-brasil">
                    <div class="logo-bandeira" onclick="abrirAdmin()" title="">
                    </div>
                </div>
                <h1>2 PARA 1000</h1>
                <p>Milhar da Sorte - Sorteio Diário!</p>
            </div>

            <!-- Botão Meus Bilhetes -->
            <div style="text-align: center; margin-bottom: 30px;">
                <button class="btn btn-secondary" onclick="mostrarMeusBilhetes()">
                    <i class="fas fa-list"></i> MEUS BILHETES
                </button>
            </div>

            <!-- Resultado do Sorteio -->
            <div class="resultado-section">
                <h2 class="resultado-title">Resultado do Sorteio de Hoje</h2>
                <div id="resultado-container-ml">
                    <div class="milhar-sorteada" id="milhar-sorteada-ml">
                        ----
                    </div>
                    <div id="status-sorteio-ml">
                        <p style="text-align: center; font-size: clamp(1.2em, 4vw, 1.5em); font-weight: 600; margin: 20px 0;">
                            Aguardando sorteio das 18h...
                        </p>
                    </div>
                </div>
                
                <div class="premio-acumulado">
                    <p style="font-size: clamp(1em, 3vw, 1.2em); margin-bottom: 10px;">Prêmio Acumulado</p>
                    <div id="premio-acumulado-valor-ml">R$ 1.000,00</div>
                </div>
            </div>

            <!-- CTA Message -->
            <div class="cta-message">
                <h3>BILHETES LIMITADOS!</h3>
                <p>Cada bilhete custa apenas <strong>R$ 2,00</strong> e pode ganhar até <strong>R$ 1.000,00!</strong></p>
                <div style="margin-top: 15px; background: rgba(255, 255, 255, 0.25); padding: 12px 20px; border-radius: 25px; font-weight: 700;">
                    Sorteio diário às 18h baseado na Lotep/PB!
                </div>
            </div>

            <div class="main-section">
                <h2>Ganhe até R$ 1.000,00!</h2>
                <p class="subtitle">Cada bilhete custa apenas <strong>R$ 2,00</strong></p>
                
                <div class="quantidade-selector">
                    <button class="quantidade-btn" onclick="diminuirQuantidadeML()">
                        -
                    </button>
                    <div id="quantidade-display-ml" class="quantidade-display">1</div>
                    <button class="quantidade-btn" onclick="aumentarQuantidadeML()">
                        +
                    </button>
                </div>
                
                <div id="total-display-ml" class="total-display">
                    Total: R$ 2,00
                </div>
                
                <button class="btn btn-cta" onclick="irParaPagamentoML()">
                    COMPRAR BILHETES
                </button>

                <div style="margin-top: 30px; display: grid; grid-template-columns: 1fr; gap: 15px; max-width: 600px; margin-left: auto; margin-right: auto;">
                    <div style="background: rgba(255, 255, 255, 0.9); padding: 15px 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); border: 2px solid rgba(40, 167, 69, 0.2); text-align: center;">
                        <span style="font-size: clamp(0.9em, 3.5vw, 1.1em); color: #666; font-weight: 600;">
                            <i class="fas fa-shield-alt" style="color: var(--success-green); margin-right: 8px;"></i>
                            Pagamento 100% seguro
                        </span>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.9); padding: 15px 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); border: 2px solid rgba(40, 167, 69, 0.2); text-align: center;">
                        <span style="font-size: clamp(0.9em, 3.5vw, 1.1em); color: #666; font-weight: 600;">
                            <i class="fas fa-clock" style="color: var(--success-green); margin-right: 8px;"></i>
                            Sorteio diário às 18h
                        </span>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.9); padding: 15px 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); border: 2px solid rgba(40, 167, 69, 0.2); text-align: center;">
                        <span style="font-size: clamp(0.9em, 3.5vw, 1.1em); color: #666; font-weight: 600;">
                            <i class="fas fa-trophy" style="color: var(--success-green); margin-right: 8px;"></i>
                            Prêmios pagos em até 24h
                        </span>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn btn-secondary" onclick="voltarSelecaoJogos()">
                        Voltar aos Jogos
                    </button>
                </div>
            </div>

            <!-- Últimos Ganhadores -->
            <div id="ultimos-ganhadores-ml" style="margin-top: 40px;"></div>
        </div>

        <!-- Página Meus Bilhetes -->
        <div id="meus-bilhetes-page" class="page">
            <div class="header">
                <div class="logo-brasil">
                    <div class="logo-bandeira"></div>
                </div>
                <h1>MEUS BILHETES</h1>
                <p>Gerencie seus bilhetes</p>
            </div>

            <div class="cliente-info" id="cliente-info-bilhetes">
                <h3>Bem-vindo(a)!</h3>
                <p>Faça login para ver seus bilhetes</p>
            </div>

            <div class="meus-bilhetes-container" id="meus-bilhetes-container">
                <div class="loading">
                    <p>Carregando seus bilhetes...</p>
                </div>
            </div>

            <div style="text-align: center; margin-top: 30px;">
                <button class="btn btn-secondary" onclick="voltar2Para1000()">
                    Voltar
                </button>
            </div>
        </div>

        <!-- Página de Pagamento 2 para 1000 -->
        <div id="2para1000-payment" class="page">
            <div class="header">
                <div class="logo-brasil">
                    <div class="logo-bandeira"></div>
                </div>
                <h1>2 PARA 1000</h1>
                <p>Finalize seu pagamento</p>
            </div>

            <div class="payment-container">
                <div style="text-align: center; margin-bottom: 40px;">
                    <h2 style="color: #1a1a1a;">Pagamento via PIX</h2>
                    <p style="font-size: clamp(1.1em, 4vw, 1.3em); margin: 15px 0; font-weight: 600; color: #1a1a1a;">
                        Quantidade: <strong><span id="quantidade-pagamento-ml">1</span> bilhete(s)</strong>
                    </p>
                    <div style="background: linear-gradient(135deg, #00b341, #003087); color: white; padding: clamp(15px, 4vw, 25px); border-radius: 15px; font-size: clamp(1.3em, 5vw, 1.8em); font-weight: 800; box-shadow: 0 8px 25px rgba(0,0,0,0.2);">
                        Total: R$ <span id="total-pagamento-ml">2,00</span>
                    </div>
                </div>

                <div id="payment-status-ml">
                    <div class="loading">
                        <p style="font-size: clamp(1.1em, 4vw, 1.3em); margin-bottom: 25px; font-weight: 600; color: #1a1a1a;">Gerando seu QR Code PIX...</p>
                    </div>
                </div>

                <div class="qr-container" id="qr-section-ml" style="display: none;">
                    <h3 style="color: #1a1a1a;">Escaneie o QR Code</h3>
                    <div id="qr-code-ml" class="qr-code"></div>
                    
                    <div style="margin: 25px 0;">
                        <p style="font-weight: 700; margin-bottom: 15px; font-size: clamp(1em, 3.5vw, 1.2em); color: #1a1a1a;">
                            Ou copie o código PIX:
                        </p>
                        <div class="pix-code" id="pix-code-ml"></div>
                        <button class="btn btn-secondary" onclick="copiarCodigoPixML()">
                            Copiar Código PIX
                        </button>
                    </div>

                    <div id="payment-actions-ml">
                        <button class="btn btn-primary" onclick="criarPagamentoRealML()" style="width: 100%; margin-top: 25px;" id="btn-real-payment-ml">
                            Pagar com PIX
                        </button>
                    </div>
                </div>

                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn btn-secondary" onclick="voltar2Para1000()">
                        Voltar
                    </button>
                </div>
            </div>
        </div>

        <!-- Página de Bilhetes -->
        <div id="2para1000-bilhetes" class="page">
            <div class="header">
                <div class="logo-brasil">
                    <div class="logo-bandeira"></div>
                </div>
                <h1>2 PARA 1000</h1>
                <p>Seus bilhetes da sorte!</p>
            </div>

            <div style="text-align: center; margin-bottom: 50px;">
                <h2 style="font-size: clamp(2em, 7vw, 3em); color: #00b341; font-weight: 800;">
                    Parabéns! Seus bilhetes foram gerados!
                </h2>
                <p style="font-size: clamp(1.2em, 5vw, 1.5em); margin: 20px 0; font-weight: 600;">
                    Você tem <strong><span id="quantidade-bilhetes-ml">1</span></strong> bilhete(s) para o sorteio de hoje
                </p>
                <div class="cta-message success" style="margin: 25px auto; max-width: 600px;">
                    <h3>Boa sorte!</h3>
                    <p>O sorteio será às 18h baseado no resultado da Lotep/PB!</p>
                </div>
            </div>

            <div id="bilhetes-container-ml">
                <!-- Bilhetes serão gerados dinamicamente -->
            </div>

            <div id="formulario-dados-ml">
                <div class="bilhete-container">
                    <h3 style="color: #4CAF50; font-size: clamp(1.5em, 5vw, 2.2em); margin-bottom: 25px; text-align: center; font-weight: 800;">
                        Complete seus dados para participar!
                    </h3>
                    
                    <div class="form-group">
                        <label>Nome Completo:</label>
                        <input type="text" id="nome-cliente-ml" placeholder="Digite seu nome completo" required>
                    </div>
                    
                    <div class="form-group">
                        <label>Telefone/WhatsApp:</label>
                        <input type="tel" id="telefone-cliente-ml" placeholder="(11) 99999-9999" required>
                    </div>
                    
                    <div class="form-group">
                        <label>Chave PIX (para receber prêmio):</label>
                        <input type="text" id="chave-pix-cliente-ml" placeholder="Digite sua chave PIX" required>
                    </div>
                    
                    <button class="btn btn-cta" onclick="enviarBilheteML()" style="width: 100%;">
                        ENVIAR BILHETE
                    </button>

                    <div style="background: linear-gradient(135deg, #e8f4f8, #d1ecf1); padding: 20px; border-radius: 12px; margin-top: 25px; font-size: clamp(0.85em, 3vw, 1em); text-align: center; border: 2px solid #17a2b8;">
                        <p><strong>Seus dados estão seguros!</strong></p>
                        <p>Complete o cadastro para participar do sorteio diário.</p>
                        <p>O sorteio acontece todos os dias às 18h!</p>
                    </div>
                </div>
            </div>

            <div style="text-align: center; margin-top: 50px;">
                <button class="btn btn-secondary" onclick="voltarSelecaoJogos()">
                    Voltar aos Jogos
                </button>
            </div>
        </div>

        <!-- Página de Afiliados -->
        <div id="affiliate-page" class="page">
            <div class="header">
                <div class="logo-brasil">
                    <div class="logo-bandeira" onclick="abrirAdmin()" title="">
                    </div>
                </div>
                <h1>PROGRAMA DE AFILIADOS</h1>
                <p>Ganhe 50% de comissão em cada venda!</p>
            </div>

            <!-- Formulário de Cadastro ou Área do Afiliado -->
            <div id="affiliate-signup">
                <div class="cta-message affiliate" style="background: linear-gradient(135deg, var(--primary-yellow), #ffcc00); color: #1a1a1a;">
                    <h3>SEJA UM AFILIADO!</h3>
                    <p>Ganhe <strong>50% de comissão</strong> em cada venda que você indicar!</p>
                    <div class="urgency-indicator">
                        <span>Funciona para ambos os jogos!</span>
                    </div>
                </div>

                <div style="background: white; padding: clamp(25px, 6vw, 40px); border-radius: var(--border-radius); box-shadow: var(--shadow-medium);">
                    <h3 style="text-align: center; margin-bottom: 30px; color: var(--affiliate-orange);">
                        Cadastre-se como Afiliado
                    </h3>
                    
                    <div class="form-group">
                        <label>Nome Completo:</label>
                        <input type="text" id="affiliate-nome" placeholder="Digite seu nome completo">
                    </div>
                    
                    <div class="form-group">
                        <label>Telefone/WhatsApp:</label>
                        <input type="tel" id="affiliate-telefone" placeholder="(11) 99999-9999">
                    </div>
                    
                    <div class="form-group">
                        <label>E-mail:</label>
                        <input type="email" id="affiliate-email" placeholder="seu@email.com">
                    </div>
                    
                    <div class="form-group">
                        <label>CPF:</label>
                        <input type="text" id="affiliate-cpf" placeholder="000.000.000-00" maxlength="14" oninput="mascaraCPF(this)">
                    </div>
                    
                    <div style="display: flex; flex-direction: column; gap: 15px; margin-top: 25px;">
                        <button class="btn btn-affiliate" onclick="cadastrarAfiliado()" style="background: linear-gradient(135deg, var(--affiliate-orange), #f7931e);">
                            CRIAR MINHA CONTA DE AFILIADO
                        </button>
                        
                        <button class="btn btn-secondary" onclick="mostrarLoginAfiliado()">
                            JÁ SOU AFILIADO
                        </button>
                    </div>
                </div>
            </div>

            <!-- Login do Afiliado -->
            <div id="affiliate-login" style="display: none;">
                <div style="background: white; padding: clamp(25px, 6vw, 40px); border-radius: var(--border-radius); box-shadow: var(--shadow-medium);">
                    <h3 style="text-align: center; margin-bottom: 30px; color: var(--affiliate-orange);">
                        Área do Afiliado
                    </h3>
                    
                    <div class="form-group">
                        <label>CPF:</label>
                        <input type="text" id="login-affiliate-cpf" placeholder="000.000.000-00" maxlength="14" oninput="mascaraCPF(this)">
                    </div>
                    
                    <div style="display: flex; flex-direction: column; gap: 15px; margin-top: 25px;">
                        <button class="btn btn-affiliate" onclick="loginAfiliado()" style="background: linear-gradient(135deg, var(--affiliate-orange), #f7931e);">
                            ENTRAR NA MINHA ÁREA
                        </button>
                        
                        <button class="btn btn-secondary" onclick="voltarCadastroAfiliado()">
                            Voltar ao Cadastro
                        </button>
                    </div>
                    
                    <div id="login-affiliate-message" style="margin-top: 20px;"></div>
                </div>
            </div>

            <!-- Área do Afiliado (após login) -->
            <div id="affiliate-dashboard" style="display: none;">
                <div class="affiliate-section">
                    <h3 style="text-align: center; color: var(--affiliate-orange); margin-bottom: 25px;">
                        Painel do Afiliado
                    </h3>
                    
                    <div style="text-align: center; margin-bottom: 30px;">
                        <h4>Bem-vindo(a), <span id="affiliate-name-display">Afiliado</span>!</h4>
                        <p>Seu link personalizado:</p>
                        <div class="affiliate-link-display" id="affiliate-link-display">
                            https://raspabrasil.com/?ref=SEUCODIGO
                        </div>
                        <button class="btn btn-secondary" onclick="copiarLinkAfiliado()" style="margin-top: 15px;">
                            Copiar Link
                        </button>
                    </div>
                    
                    <div class="affiliate-stats">
                        <div class="affiliate-stat-item">
                            <span class="affiliate-stat-number" id="affiliate-clicks">0</span>
                            <span class="affiliate-stat-label">Cliques</span>
                        </div>
                        <div class="affiliate-stat-item">
                            <span class="affiliate-stat-number" id="affiliate-sales">0</span>
                            <span class="affiliate-stat-label">Vendas</span>
                        </div>
                        <div class="affiliate-stat-item">
                            <span class="affiliate-stat-number" id="affiliate-commission">R$ 0,00</span>
                            <span class="affiliate-stat-label">Comissão Total</span>
                        </div>
                        <div class="affiliate-stat-item">
                            <span class="affiliate-stat-number" id="affiliate-balance">R$ 0,00</span>
                            <span class="affiliate-stat-label">Saldo</span>
                        </div>
                    </div>
                    
                    <div style="background: white; padding: 25px; border-radius: 15px; margin-top: 30px;">
                        <h4 style="color: var(--affiliate-orange); margin-bottom: 20px;">
                            Configurar PIX para Saque
                        </h4>
                        
                        <div class="form-group">
                            <label>Tipo de Chave PIX:</label>
                            <select id="affiliate-pix-type">
                                <option value="cpf">CPF</option>
                                <option value="email">E-mail</option>
                                <option value="telefone">Telefone</option>
                                <option value="aleatoria">Chave Aleatória</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Chave PIX:</label>
                            <input type="text" id="affiliate-pix-key" placeholder="Digite sua chave PIX">
                        </div>
                        
                        <div style="display: flex; flex-direction: column; gap: 15px; margin-top: 25px;">
                            <button class="btn btn-primary" onclick="salvarChavePix()">
                                Salvar Chave PIX
                            </button>
                            
                            <button class="btn btn-affiliate" onclick="solicitarSaque()" id="btn-saque" disabled style="background: linear-gradient(135deg, var(--affiliate-orange), #f7931e);">
                                Solicitar Saque (Min. R$ 10,00)
                            </button>
                        </div>
                    </div>
                    
                    <div class="cta-message success" style="margin-top: 30px;">
                        <h4>Dicas para Aumentar suas Vendas:</h4>
                        <ul style="text-align: left; margin: 15px 0; padding-left: 20px;">
                            <li>Compartilhe nas redes sociais (Instagram, Facebook, TikTok)</li>
                            <li>Envie para grupos de WhatsApp e Telegram</li>
                            <li>Conte para amigos e família sobre os prêmios</li>
                            <li>Mostre os ganhadores para aumentar a credibilidade</li>
                        </ul>
                    </div>
                    
                    <div style="text-align: center; margin-top: 30px;">
                        <button class="btn btn-secondary" onclick="logoutAfiliado()">
                            Sair da Conta
                        </button>
                    </div>
                </div>
            </div>

            <div style="text-align: center; margin-top: 40px;">
                <button class="btn btn-secondary" onclick="voltarSelecaoJogos()">
                    Voltar aos Jogos
                </button>
            </div>
        </div>
    </div>

    <!-- Modal Admin Unificado -->
    <div id="admin-modal" class="admin-modal">
        <div class="admin-modal-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                <h2>Área Administrativa - GANHA BRASIL</h2>
                <button onclick="fecharAdmin()" style="background: none; border: none; font-size: 30px; cursor: pointer; color: #666;">×</button>
            </div>

            <div id="admin-login">
                <div class="form-group">
                    <label>Senha Administrativa:</label>
                    <input type="password" id="admin-senha" placeholder="Digite a senha">
                </div>
                <button class="btn btn-primary" onclick="loginAdmin()" style="width: 100%;">
                    Entrar
                </button>
                <div id="admin-message" style="margin-top: 20px;"></div>
            </div>

            <div id="admin-panel" style="display: none;">
                <!-- Abas do Admin -->
                <div class="admin-tabs">
                    <div class="admin-tab active" onclick="trocarAbaAdmin('dashboard')">Dashboard</div>
                    <div class="admin-tab" onclick="trocarAbaAdmin('controle-premios')">Prêmios RB</div>
                    <div class="admin-tab" onclick="trocarAbaAdmin('sorteio-ml')">Sorteio ML</div>
                    <div class="admin-tab" onclick="trocarAbaAdmin('afiliados')">Afiliados</div>
                    <div class="admin-tab" onclick="trocarAbaAdmin('saques')">Saques</div>
                    <div class="admin-tab" onclick="trocarAbaAdmin('bilhetes')">Bilhetes</div>
                    <div class="admin-tab" onclick="trocarAbaAdmin('raspadinhas')">Raspadinhas</div>
                    <div class="admin-tab" onclick="trocarAbaAdmin('ganhadores')">Ganhadores</div>
                    <div class="admin-tab" onclick="trocarAbaAdmin('vendas')">Vendas</div>
                </div>

                <!-- Dashboard -->
                <div id="admin-dashboard" class="admin-tab-content active">
                    <div class="status-bar">
                        <div class="status-item">
                            <span class="number" id="admin-vendidas-rb">0</span>
                            <span class="label">Raspadinhas Vendidas</span>
                        </div>
                        <div class="status-item">
                            <span class="number" id="admin-vendidos-ml">0</span>
                            <span class="label">Bilhetes Vendidos</span>
                        </div>
                        <div class="status-item">
                            <span class="number" id="admin-ganhadores-total">0</span>
                            <span class="label">Ganhadores Total</span>
                        </div>
                        <div class="status-item">
                            <span class="number" id="admin-afiliados">0</span>
                            <span class="label">Afiliados</span>
                        </div>
                        <div class="status-item">
                            <span class="number" id="admin-clientes">0</span>
                            <span class="label">Clientes</span>
                        </div>
                    </div>
                    
                    <div style="margin-top: 30px; background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.1);">
                        <h3 style="color: #00b341; margin-bottom: 20px;">Status do Sistema</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <div style="padding: 15px; background: #f8f9fa; border-radius: 10px; text-align: center;">
                                <div style="font-size: 1.5em; font-weight: 800; color: #28a745;" id="admin-sistema-status">ATIVO</div>
                                <div style="color: #666;">Sistema Raspa Brasil</div>
                            </div>
                            <div style="padding: 15px; background: #f8f9fa; border-radius: 10px; text-align: center;">
                                <div style="font-size: 1.5em; font-weight: 800; color: #007bff;" id="admin-premio-acumulado">R$ 1.000,00</div>
                                <div style="color: #666;">Prêmio 2 para 1000</div>
                            </div>
                            <div style="padding: 15px; background: #f8f9fa; border-radius: 10px; text-align: center;">
                                <div style="font-size: 1.5em; font-weight: 800; color: #dc2626;" id="admin-vendas-hoje">0</div>
                                <div style="color: #666;">Vendas Hoje</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Controle de Prêmios Raspa Brasil -->
                <div id="admin-controle-premios" class="admin-tab-content">
                    <div style="background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.1);">
                        <h3 style="color: #00b341; margin-bottom: 25px; text-align: center;">Controle de Prêmios - Raspa Brasil</h3>
                        
                        <div style="margin-bottom: 30px; padding: 20px; background: linear-gradient(135deg, #fff3cd, #ffeaa7); border-radius: 12px; border: 2px solid #ffc107;">
                            <h4 style="color: #856404; margin-bottom: 15px;">Sistema Manual de Prêmios</h4>
                            <p style="color: #856404; margin-bottom: 0;">Libere prêmios manualmente para a próxima raspagem. Apenas um prêmio pode ser liberado por vez.</p>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                                <span style="font-weight: 700;">Status do Sistema:</span>
                                <span id="admin-sistema-rb-status" style="padding: 8px 16px; border-radius: 20px; font-weight: 700; background: #d4edda; color: #155724;">ATIVO</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 15px;">
                                <span style="font-weight: 700;">Prêmio Liberado:</span>
                                <span id="admin-premio-liberado-status" style="padding: 8px 16px; border-radius: 20px; font-weight: 700; background: #f8d7da; color: #721c24;">NENHUM</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Liberar Prêmio para Próxima Raspagem:</label>
                            <select id="admin-valor-premio" style="width: 100%; padding: 15px; border: 2px solid #ddd; border-radius: 10px; font-size: 16px;">
                                <option value="">Selecione o valor do prêmio</option>
                                <option value="R$ 1,00">R$ 1,00</option>
                                <option value="R$ 2,00">R$ 2,00</option>
                                <option value="R$ 5,00">R$ 5,00</option>
                                <option value="R$ 10,00">R$ 10,00</option>
                                <option value="R$ 20,00">R$ 20,00</option>
                                <option value="R$ 50,00">R$ 50,00</option>
                                <option value="R$ 100,00">R$ 100,00</option>
                                <option value="R$ 200,00">R$ 200,00</option>
                                <option value="R$ 500,00">R$ 500,00</option>
                                <option value="R$ 1.000,00">R$ 1.000,00</option>
                            </select>
                        </div>
                        
                        <button class="btn btn-primary" onclick="liberarPremioManual()" style="width: 100%; margin-top: 20px;" id="btn-liberar-premio">
                            LIBERAR PRÊMIO
                        </button>
                        
                        <div id="admin-premio-message" style="margin-top: 20px;"></div>
                        
                        <div style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                            <h4 style="color: #495057; margin-bottom: 15px;">Instruções:</h4>
                            <ul style="color: #6c757d; line-height: 1.6;">
                                <li>Selecione o valor do prêmio que deseja liberar</li>
                                <li>Clique em "LIBERAR PRÊMIO" para disponibilizar</li>
                                <li>O prêmio será entregue na próxima raspagem</li>
                                <li>Apenas um prêmio pode estar liberado por vez</li>
                                <li>Acompanhe o status na aba Dashboard</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Sorteio 2 para 1000 -->
                <div id="admin-sorteio-ml" class="admin-tab-content">
                    <div style="background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.1);">
                        <h3 style="color: #007bff; margin-bottom: 25px; text-align: center;">Sorteio Diário - 2 para 1000</h3>
                        
                        <div style="margin-bottom: 30px; padding: 20px; background: linear-gradient(135deg, #d1ecf1, #bee5eb); border-radius: 12px; border: 2px solid #17a2b8;">
                            <h4 style="color: #0c5460; margin-bottom: 15px;">Resultado de Hoje</h4>
                            <div id="admin-resultado-hoje">
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                                    <div style="text-align: center;">
                                        <div style="font-size: 2em; font-weight: 800; color: #007bff;" id="admin-milhar-hoje">----</div>
                                        <div style="color: #6c757d;">Milhar Sorteada</div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 1.5em; font-weight: 800;" id="admin-status-ganhador">Aguardando</div>
                                        <div style="color: #6c757d;">Status</div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 1.5em; font-weight: 800; color: #28a745;" id="admin-premio-atual">R$ 1.000,00</div>
                                        <div style="color: #6c757d;">Prêmio Acumulado</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <h4 style="color: #495057; margin-bottom: 15px;">Editar Prêmio Acumulado</h4>
                            <div style="display: flex; gap: 15px; align-items: end;">
                                <div class="form-group" style="flex: 1; margin: 0;">
                                    <label>Novo valor:</label>
                                    <input type="text" id="admin-novo-premio-ml" placeholder="1000.00" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px;">
                                </div>
                                <button class="btn btn-secondary" onclick="editarPremioML()" style="width: 150px;">
                                    Atualizar
                                </button>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <h4 style="color: #495057; margin-bottom: 15px;">Participantes de Hoje</h4>
                            <div style="padding: 15px; background: #f8f9fa; border-radius: 10px; text-align: center;">
                                <span style="font-size: 2em; font-weight: 800; color: #007bff;" id="admin-participantes-hoje">0</span>
                                <span style="color: #6c757d; margin-left: 10px;">bilhetes vendidos hoje</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Milhar Sorteada (resultado da Lotep/PB):</label>
                            <input type="text" id="admin-milhar-sorteada" placeholder="Digite os 4 últimos números" maxlength="4" style="width: 100%; padding: 15px; border: 2px solid #ddd; border-radius: 10px; font-size: 18px; font-weight: 800; text-align: center; letter-spacing: 2px;">
                        </div>
                        
                        <button class="btn btn-primary" onclick="realizarSorteio()" style="width: 100%; margin-top: 20px; background: linear-gradient(135deg, #007bff, #0056b3);" id="btn-sortear">
                            REALIZAR SORTEIO
                        </button>
                        
                        <div id="admin-sorteio-message" style="margin-top: 20px;"></div>
                        
                        <div style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                            <h4 style="color: #495057; margin-bottom: 15px;">Instruções:</h4>
                            <ul style="color: #6c757d; line-height: 1.6;">
                                <li>Aguarde o resultado da Lotep/PB às 18h</li>
                                <li>Digite os 4 últimos números do resultado</li>
                                <li>Clique em "REALIZAR SORTEIO" para processar</li>
                                <li>O sistema verificará automaticamente se há ganhadores</li>
                                <li>Prêmios não ganhos acumulam para o próximo sorteio</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Afiliados -->
                <div id="admin-afiliados" class="admin-tab-content">
                    <div style="background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.1);">
                        <h3 style="color: #ff6b35; margin-bottom: 25px; text-align: center;">Gestão de Afiliados</h3>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
                            <div style="padding: 20px; background: #f8f9fa; border-radius: 10px; text-align: center;">
                                <div style="font-size: 2em; font-weight: 800; color: #ff6b35;" id="admin-total-afiliados">0</div>
                                <div style="color: #6c757d;">Total de Afiliados</div>
                            </div>
                            <div style="padding: 20px; background: #f8f9fa; border-radius: 10px; text-align: center;">
                                <div style="font-size: 2em; font-weight: 800; color: #28a745;" id="admin-vendas-afiliados">0</div>
                                <div style="color: #6c757d;">Vendas por Afiliados</div>
                            </div>
                            <div style="padding: 20px; background: #f8f9fa; border-radius: 10px; text-align: center;">
                                <div style="font-size: 2em; font-weight: 800; color: #dc2626;" id="admin-comissoes-pagas">R$ 0,00</div>
                                <div style="color: #6c757d;">Comissões Pagas</div>
                            </div>
                            <div style="padding: 20px; background: #f8f9fa; border-radius: 10px; text-align: center;">
                                <div style="font-size: 2em; font-weight: 800; color: #007bff;" id="admin-saques-pendentes">0</div>
                                <div style="color: #6c757d;">Saques Pendentes</div>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <h4 style="color: #495057; margin-bottom: 15px;">Lista de Afiliados</h4>
                            <div id="admin-lista-afiliados" style="background: #f8f9fa; border-radius: 10px; min-height: 300px; padding: 20px; max-height: 400px; overflow-y: auto;">
                                <div style="text-align: center; color: #6c757d; padding: 100px 0;">
                                    Carregando dados dos afiliados...
                                </div>
                            </div>
                        </div>
                        
                        <button class="btn btn-secondary" onclick="carregarDadosAfiliados()" style="width: 100%;">
                            ATUALIZAR DADOS
                        </button>
                    </div>
                </div>

                <!-- Saques dos Afiliados -->
                <div id="admin-saques" class="admin-tab-content">
                    <div style="background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.1);">
                        <h3 style="color: #007bff; margin-bottom: 25px; text-align: center;">Gerenciamento de Saques</h3>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
                            <div style="padding: 20px; background: #f8f9fa; border-radius: 10px; text-align: center;">
                                <div style="font-size: 2em; font-weight: 800; color: #ffc107;" id="admin-saques-pendentes-total">0</div>
                                <div style="color: #6c757d;">Saques Pendentes</div>
                            </div>
                            <div style="padding: 20px; background: #f8f9fa; border-radius: 10px; text-align: center;">
                                <div style="font-size: 2em; font-weight: 800; color: #28a745;" id="admin-saques-pagos-total">0</div>
                                <div style="color: #6c757d;">Saques Pagos</div>
                            </div>
                            <div style="padding: 20px; background: #f8f9fa; border-radius: 10px; text-align: center;">
                                <div style="font-size: 2em; font-weight: 800; color: #007bff;" id="admin-valor-total-saques">R$ 0,00</div>
                                <div style="color: #6c757d;">Valor Total</div>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <div style="display: flex; gap: 15px; margin-bottom: 20px; flex-wrap: wrap;">
                                <button class="btn btn-secondary" onclick="carregarSaques('pendente')" id="btn-saques-pendentes">
                                    Pendentes
                                </button>
                                <button class="btn btn-secondary" onclick="carregarSaques('pago')" id="btn-saques-pagos">
                                    Pagos
                                </button>
                                <button class="btn btn-primary" onclick="carregarSaques('todos')" id="btn-saques-todos">
                                    Todos
                                </button>
                            </div>
                        </div>
                        
                        <div id="admin-lista-saques" style="background: #f8f9fa; border-radius: 10px; min-height: 300px; padding: 20px; max-height: 500px; overflow-y: auto;">
                            <div style="text-align: center; color: #6c757d; padding: 100px 0;">
                                Selecione uma categoria para visualizar os saques
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bilhetes Vendidos -->
                <div id="admin-bilhetes" class="admin-tab-content">
                    <div style="background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.1);">
                        <h3 style="color: #6f42c1; margin-bottom: 25px; text-align: center;">Bilhetes Vendidos - 2 para 1000</h3>
                        
                        <div style="margin-bottom: 25px;">
                            <div style="display: flex; gap: 15px; margin-bottom: 20px; align-items: center; flex-wrap: wrap;">
                                <input type="date" id="filtro-data-bilhetes" style="padding: 10px; border: 2px solid #ddd; border-radius: 8px;">
                                <button class="btn btn-primary" onclick="carregarBilhetes()">
                                    Buscar Bilhetes
                                </button>
                                <button class="btn btn-secondary" onclick="carregarBilhetesHoje()">
                                    Bilhetes de Hoje
                                </button>
                            </div>
                        </div>
                        
                       <div id="admin-lista-bilhetes" style="background: #f8f9fa; border-radius: 10px; min-height: 300px; padding: 20px; max-height: 500px; overflow-y: auto;">
                            <div style="text-align: center; color: #6c757d; padding: 100px 0;">
                                Clique em "Bilhetes de Hoje" ou selecione uma data para visualizar
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Raspadinhas -->
                <div id="admin-raspadinhas" class="admin-tab-content">
                    <div style="background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.1);">
                        <h3 style="color: #00b341; margin-bottom: 25px; text-align: center;">Raspadinhas Vendidas - Raspa Brasil</h3>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
                            <div style="padding: 20px; background: #f8f9fa; border-radius: 10px; text-align: center;">
                                <div style="font-size: 2em; font-weight: 800; color: #00b341;" id="admin-raspadinhas-vendidas">0</div>
                                <div style="color: #6c757d;">Total Vendidas</div>
                            </div>
                            <div style="padding: 20px; background: #f8f9fa; border-radius: 10px; text-align: center;">
                                <div style="font-size: 2em; font-weight: 800; color: #007bff;" id="admin-raspadinhas-usadas">0</div>
                                <div style="color: #6c757d;">Já Raspadas</div>
                            </div>
                            <div style="padding: 20px; background: #f8f9fa; border-radius: 10px; text-align: center;">
                                <div style="font-size: 2em; font-weight: 800; color: #ffc107;" id="admin-raspadinhas-pendentes">0</div>
                                <div style="color: #6c757d;">Pendentes</div>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <div style="display: flex; gap: 15px; margin-bottom: 20px; align-items: center; flex-wrap: wrap;">
                                <input type="date" id="filtro-data-raspadinhas" style="padding: 10px; border: 2px solid #ddd; border-radius: 8px;">
                                <button class="btn btn-primary" onclick="carregarRaspadinhas()">
                                    Buscar Vendas
                                </button>
                                <button class="btn btn-secondary" onclick="carregarRaspadinhasHoje()">
                                    Vendas de Hoje
                                </button>
                            </div>
                        </div>
                        
                        <div id="admin-lista-raspadinhas" style="background: #f8f9fa; border-radius: 10px; min-height: 300px; padding: 20px; max-height: 500px; overflow-y: auto;">
                            <div style="text-align: center; color: #6c757d; padding: 100px 0;">
                                Clique em "Vendas de Hoje" ou selecione uma data para visualizar
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Ganhadores -->
                <div id="admin-ganhadores" class="admin-tab-content">
                    <div style="background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.1);">
                        <h3 style="color: #28a745; margin-bottom: 25px; text-align: center;">Gerenciamento de Ganhadores</h3>
                        
                        <div style="margin-bottom: 25px;">
                            <div style="display: flex; gap: 15px; margin-bottom: 20px; flex-wrap: wrap; align-items: center;">
                                <input type="date" id="filtro-data-ganhadores" style="padding: 10px; border: 2px solid #ddd; border-radius: 8px;">
                                <button class="btn btn-secondary" onclick="carregarGanhadores('raspa_brasil')" id="btn-ganhadores-rb">
                                    Raspa Brasil
                                </button>
                                <button class="btn btn-secondary" onclick="carregarGanhadores('2para1000')" id="btn-ganhadores-ml">
                                    2 para 1000
                                </button>
                                <button class="btn btn-primary" onclick="carregarGanhadores('todos')" id="btn-ganhadores-todos">
                                    Todos
                                </button>
                            </div>
                            <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                                <button class="btn btn-affiliate" onclick="adicionarGanhador()" style="background: linear-gradient(135deg, #28a745, #1e7e34);">
                                    Adicionar Ganhador
                                </button>
                                <button class="btn btn-secondary" onclick="gerarListaGanhadoresDia()">
                                    Lista do Dia
                                </button>
                                <button class="btn btn-primary" onclick="gerarListaGanhadoresPDF()">
                                    Gerar PDF
                                </button>
                            </div>
                        </div>
                        
                        <div id="admin-lista-ganhadores" style="background: #f8f9fa; border-radius: 10px; min-height: 300px; padding: 20px; max-height: 500px; overflow-y: auto;">
                            <div style="text-align: center; color: #6c757d; padding: 100px 0;">
                                Selecione uma categoria para visualizar os ganhadores
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Vendas -->
                <div id="admin-vendas" class="admin-tab-content">
                    <div style="background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.1);">
                        <h3 style="color: #6f42c1; margin-bottom: 25px; text-align: center;">Relatório de Vendas</h3>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 30px;">
                            <div style="padding: 15px; background: #f8f9fa; border-radius: 10px; text-align: center;">
                                <div style="font-size: 1.5em; font-weight: 800; color: #00b341;" id="admin-vendas-rb-total">0</div>
                                <div style="color: #6c757d;">Raspadinhas</div>
                            </div>
                            <div style="padding: 15px; background: #f8f9fa; border-radius: 10px; text-align: center;">
                                <div style="font-size: 1.5em; font-weight: 800; color: #007bff;" id="admin-vendas-ml-total">0</div>
                                <div style="color: #6c757d;">Bilhetes ML</div>
                            </div>
                            <div style="padding: 15px; background: #f8f9fa; border-radius: 10px; text-align: center;">
                                <div style="font-size: 1.5em; font-weight: 800; color: #28a745;" id="admin-receita-total">R$ 0,00</div>
                                <div style="color: #6c757d;">Receita Total</div>
                            </div>
                            <div style="padding: 15px; background: #f8f9fa; border-radius: 10px; text-align: center;">
                                <div style="font-size: 1.5em; font-weight: 800; color: #dc2626;" id="admin-vendas-hoje-total">0</div>
                                <div style="color: #6c757d;">Vendas Hoje</div>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <h4 style="color: #495057; margin-bottom: 15px;">Vendas dos Últimos 7 Dias</h4>
                            <div id="admin-grafico-vendas" style="background: #f8f9fa; border-radius: 10px; min-height: 200px; padding: 20px;">
                                <div style="text-align: center; color: #6c757d; padding: 50px 0;">
                                    Dados de vendas dos últimos dias
                                </div>
                            </div>
                        </div>
                        
                        <button class="btn btn-secondary" onclick="carregarRelatorioVendas()" style="width: 100%;">
                            ATUALIZAR RELATÓRIO
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal personalizado -->
    <div id="custom-modal" class="modal">
        <div class="modal-content">
            <div id="modal-message"></div>
            <div style="margin-top: 25px;">
                <button class="btn btn-secondary" onclick="fecharModal()">OK</button>
            </div>
        </div>
    </div>

    <!-- Modal para adicionar ganhador -->
    <div id="modal-adicionar-ganhador" class="modal">
        <div class="modal-content">
            <h3 style="margin-bottom: 25px; text-align: center; color: #28a745;">Adicionar Ganhador Manual</h3>
            
            <div class="form-group">
                <label>Tipo de Jogo:</label>
                <select id="novo-ganhador-jogo" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px;" onchange="toggleBilheteField()">
                    <option value="raspa_brasil">Raspa Brasil</option>
                    <option value="2para1000">2 para 1000</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Nome do Ganhador:</label>
                <input type="text" id="novo-ganhador-nome" placeholder="Digite o nome completo" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px;">
            </div>
            
            <div class="form-group">
                <label>Valor do Prêmio:</label>
                <input type="text" id="novo-ganhador-valor" placeholder="R$ 100,00" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px;">
            </div>
            
            <div class="form-group">
                <label>Chave PIX:</label>
                <input type="text" id="novo-ganhador-pix" placeholder="Digite a chave PIX" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px;">
            </div>

            <div class="form-group" id="grupo-bilhete-ml" style="display: none;">
                <label>Bilhete Ganhador (4 dígitos):</label>
                <input type="text" id="novo-ganhador-bilhete" placeholder="1234" maxlength="4" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; text-align: center; font-weight: 800; letter-spacing: 2px;">
            </div>
            
            <div style="display: flex; gap: 15px; margin-top: 25px;">
                <button class="btn btn-secondary" onclick="fecharModalAdicionarGanhador()" style="flex: 1;">
                    Cancelar
                </button>
                <button class="btn btn-primary" onclick="salvarNovoGanhador()" style="flex: 1;">
                    Salvar Ganhador
                </button>
            </div>
        </div>
    </div>

    <!-- Winner Alert Modal -->
    <div id="winner-alert" class="winner-alert">
        <div class="winner-alert-content">
            <h2>ALGUÉM ACABOU DE GANHAR!</h2>
            <p><strong id="winner-name-alert">Maria Santos</strong></p>
            <p>acabou de ganhar <strong style="font-size: 1.5em;">R$ 1.000,00!</strong></p>
            <p>Seja o próximo ganhador!</p>
            <button class="close-btn" onclick="closeWinnerAlert()">QUERO JOGAR AGORA!</button>
        </div>
    </div>

    <script>
        // CONFIGURAÇÃO DO HORÁRIO DE BRASÍLIA (UTC-3)
        function obterDataHoraBrasilia() {
            const agora = new Date();
            const utc = agora.getTime() + (agora.getTimezoneOffset() * 60000);
            const brasilia = new Date(utc + (-3 * 3600000));
            return brasilia;
        }

        // Variáveis globais
        let quantidadeRB = 1;
        let quantidadeML = 1;
        let paymentCheckInterval;
        let currentPaymentId = null;
        let currentSlide = 0;
        let currentAffiliate = null;
        let currentAdminTab = 'dashboard';
        let gameMode = null;
        let clienteLogado = null;
        const WHATSAPP_NUMERO = "5582996092684";

        // Sistema de nomes aleatórios para alertas de ganhadores
        const nomesAleatorios = [
            "Ana Beatriz Silva", "Carlos Eduardo Santos", "Maria Fernanda Costa", 
            "João Paulo Oliveira", "Juliana Rodrigues", "Pedro Henrique Lima",
            "Fernanda Almeida", "Roberto Carlos Pereira", "Mariana Souza",
            "André Luiz Ferreira", "Camila Martins", "Diego Nascimento",
            "Larissa Barbosa", "Rafael Moreira", "Tatiana Ribeiro",
            "Bruno Gonçalves", "Priscila Araújo", "Thiago Cardoso",
            "Vanessa Mendes", "Lucas Gabriel Torres", "Amanda Silva Santos",
            "Rodrigo Alves", "Bianca Fonseca", "Mateus Vieira",
            "Gabriela Rocha", "Felipe Machado", "Caroline Duarte",
            "Daniel Freitas", "Letícia Campos", "Gustavo Ramos",
            "Isabela Monteiro", "Henrique Batista", "Patrícia Lemos"
        ];

        const valoresAleatorios = [10, 20, 30, 40, 50, 100, 200, 500, 1000];

        function gerarGanhadorAleatorio() {
            const nome = nomesAleatorios[Math.floor(Math.random() * nomesAleatorios.length)];
            const valor = valoresAleatorios[Math.floor(Math.random() * valoresAleatorios.length)];
            return { nome, valor };
        }

        function gerarGanhadoresSlider() {
            const container = document.getElementById('winners-container');
            container.innerHTML = '';
            
            for (let i = 0; i < 20; i++) {
                const ganhador = gerarGanhadorAleatorio();
                const minutos = Math.floor(Math.random() * 120) + 5;
                
                let tempoTexto;
                if (minutos < 60) {
                    tempoTexto = `Há ${minutos} minutos`;
                } else {
                    const horas = Math.floor(minutos / 60);
                    const minutosRestantes = minutos % 60;
                    if (minutosRestantes === 0) {
                        tempoTexto = `Há ${horas} hora${horas > 1 ? 's' : ''}`;
                    } else {
                        tempoTexto = `Há ${horas}h ${minutosRestantes}min`;
                    }
                }
                
                const item = document.createElement('div');
                item.className = 'winner-item';
                item.innerHTML = `
                    <div class="winner-name">${ganhador.nome}</div>
                    <div class="winner-prize">R$ ${ganhador.valor},00</div>
                    <div class="winner-time">${tempoTexto}</div>
                `;
                container.appendChild(item);
            }
            
            // Duplicar para loop contínuo
            const originalHTML = container.innerHTML;
            container.innerHTML = originalHTML + originalHTML;

            // Gerar também para Raspa Brasil
            const containerRB = document.getElementById('winners-container-rb');
            if (containerRB) {
                containerRB.innerHTML = container.innerHTML;
            }
        }

        function showWinnerAlert() {
            if (!document.getElementById('game-selection-page').classList.contains('active')) {
                return;
            }

            if (window.alertInProgress) {
                return;
            }

            window.alertInProgress = true;

            const ganhador = gerarGanhadorAleatorio();
            document.getElementById('winner-name-alert').textContent = ganhador.nome;
            document.querySelector('#winner-alert .winner-alert-content p:nth-child(3)').innerHTML = 
                `acabou de ganhar <strong style="font-size: 1.5em;">R$ ${ganhador.valor},00!</strong>`;
            
            document.getElementById('winner-alert').style.display = 'flex';
            
            if (navigator.vibrate) {
                navigator.vibrate([100, 50, 100]);
            }
            
            setTimeout(() => {
                closeWinnerAlert();
            }, 5000);
        }

        function closeWinnerAlert() {
            document.getElementById('winner-alert').style.display = 'none';
            window.alertInProgress = false;
        }

        function initWinnerAlerts() {
            setTimeout(() => {
                if (document.getElementById('game-selection-page').classList.contains('active')) {
                    showWinnerAlert();
                }
            }, 10000);
            
            setInterval(() => {
                if (Math.random() < 0.15 && document.getElementById('game-selection-page').classList.contains('active') && !window.alertInProgress) {
                    showWinnerAlert();
                }
            }, 90000);
        }

        function formatarDinheiro(valor) {
            return valor.toFixed(2).replace('.', ',');
        }

        function mostrarModal(mensagem) {
            document.getElementById('modal-message').innerHTML = mensagem;
            document.getElementById('custom-modal').style.display = 'flex';
        }

        function fecharModal() {
            document.getElementById('custom-modal').style.display = 'none';
        }

        function showConfirmDialog(message, onConfirm) {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'flex';
            modal.innerHTML = `
                <div class="modal-content">
                    <p style="margin-bottom: 25px; font-size: 16px; line-height: 1.5;">${message}</p>
                    <div style="display: flex; gap: 15px;">
                        <button class="btn btn-secondary" onclick="this.closest('.modal').remove()" style="flex: 1;">Cancelar</button>
                        <button class="btn btn-primary" onclick="this.closest('.modal').remove(); typeof ${onConfirm.name} === 'function' && ${onConfirm.name}()" style="flex: 1;">Confirmar</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function showAlert(message) {
            mostrarModal(`<h3>Aviso</h3><p>${message}</p>`);
        }

        function mascaraCPF(input) {
            let cpf = input.value.replace(/\D/g, '');
            cpf = cpf.replace(/(\d{3})(\d)/, '$1.$2');
            cpf = cpf.replace(/(\d{3})(\d)/, '$1.$2');
            cpf = cpf.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
            input.value = cpf;
        }

        function initBannerSlider() {
            const slides = document.querySelectorAll('.banner-slider .slide');
            
            setInterval(() => {
                slides[currentSlide].classList.remove('active');
                currentSlide = (currentSlide + 1) % slides.length;
                slides[currentSlide].classList.add('active');
            }, 5000);
        }

        function mostrarPagina(pageId) {
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => page.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
        }

        // Sistema de Login/Cadastro de Clientes
        function verificarLogin() {
            fetch('/cliente/verificar_login')
                .then(response => response.json())
                .then(data => {
                    if (data.logado) {
                        clienteLogado = data.cliente;
                        atualizarInterfaceLogin();
                    } else {
                        clienteLogado = null;
                        atualizarInterfaceLogin();
                    }
                })
                .catch(error => {
                    console.error('Erro ao verificar login:', error);
                });
        }

        function atualizarInterfaceLogin() {
            const btnLogin = document.getElementById('btn-login-top');
            const btnLogout = document.getElementById('btn-logout-top');
            const nomeDisplay = document.getElementById('cliente-nome-display');
            
            if (clienteLogado) {
                btnLogin.style.display = 'none';
                btnLogout.style.display = 'inline-block';
                nomeDisplay.style.display = 'inline';
                nomeDisplay.querySelector('strong').textContent = clienteLogado.nome.split(' ')[0];
            } else {
                btnLogin.style.display = 'inline-block';
                btnLogout.style.display = 'none';
                nomeDisplay.style.display = 'none';
            }
        }

        function mostrarLogin() {
            mostrarPagina('login-page');
        }

        function trocarAbaLogin(aba) {
            const tabs = document.querySelectorAll('.login-tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            if (aba === 'login') {
                tabs[0].classList.add('active');
                document.getElementById('login-form').style.display = 'block';
                document.getElementById('cadastro-form').style.display = 'none';
            } else {
                tabs[1].classList.add('active');
                document.getElementById('login-form').style.display = 'none';
                document.getElementById('cadastro-form').style.display = 'block';
            }
        }

        async function fazerLogin() {
            const cpf = document.getElementById('login-cpf').value.replace(/\D/g, '');
            const messageDiv = document.getElementById('login-message');
            
            if (!cpf || cpf.length !== 11) {
                messageDiv.innerHTML = '<div style="color: #dc2626;">Digite um CPF válido</div>';
                return;
            }
            
            try {
                const response = await fetch('/cliente/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ cpf })
                });
                
                const resultado = await response.json();
                
                if (resultado.sucesso) {
                    clienteLogado = resultado.cliente;
                    atualizarInterfaceLogin();
                    mostrarPagina('game-selection-page');
                    mostrarModal('<h3>Login realizado!</h3><p>Bem-vindo(a) de volta!</p>');
                } else {
                    messageDiv.innerHTML = `<div style="color: #dc2626;">${resultado.erro}</div>`;
                }
            } catch (error) {
                console.error('Erro ao fazer login:', error);
                messageDiv.innerHTML = '<div style="color: #dc2626;">Erro ao fazer login. Tente novamente.</div>';
            }
        }

        async function fazerCadastro() {
            const nome = document.getElementById('cadastro-nome').value.trim();
            const cpf = document.getElementById('cadastro-cpf').value.replace(/\D/g, '');
            const telefone = document.getElementById('cadastro-telefone').value.trim();
            const email = document.getElementById('cadastro-email').value.trim();
            const messageDiv = document.getElementById('cadastro-message');
            
            if (!nome || nome.length < 3) {
                messageDiv.innerHTML = '<div style="color: #dc2626;">Nome deve ter pelo menos 3 caracteres</div>';
                return;
            }
            
            if (!cpf || cpf.length !== 11) {
                messageDiv.innerHTML = '<div style="color: #dc2626;">Digite um CPF válido</div>';
                return;
            }
            
            try {
                const response = await fetch('/cliente/cadastrar', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ nome, cpf, telefone, email })
                });
                
                const resultado = await response.json();
                
                if (resultado.sucesso) {
                    clienteLogado = resultado.cliente;
                    atualizarInterfaceLogin();
                    mostrarPagina('game-selection-page');
                    mostrarModal('<h3>Cadastro realizado!</h3><p>Bem-vindo(a) ao Ganha Brasil!</p>');
                } else {
                    messageDiv.innerHTML = `<div style="color: #dc2626;">${resultado.erro}</div>`;
                }
            } catch (error) {
                console.error('Erro ao fazer cadastro:', error);
                messageDiv.innerHTML = '<div style="color: #dc2626;">Erro ao fazer cadastro. Tente novamente.</div>';
            }
        }

        async function logoutCliente() {
            try {
                const response = await fetch('/cliente/logout');
                const resultado = await response.json();
                
                if (resultado.sucesso) {
                    clienteLogado = null;
                    atualizarInterfaceLogin();
                    mostrarPagina('game-selection-page');
                    mostrarModal('<h3>Logout realizado!</h3><p>Até logo!</p>');
                }
            } catch (error) {
                console.error('Erro ao fazer logout:', error);
            }
        }

        // Navegação principal
        function voltarSelecaoJogos() {
            mostrarPagina('game-selection-page');
        }

        function irParaRaspaBrasil() {
            if (!clienteLogado) {
                mostrarModal('<h3>Login necessário</h3><p>Faça login para jogar Raspa Brasil!</p>');
                mostrarLogin();
                return;
            }
            gameMode = 'rb';
            mostrarPagina('raspa-brasil-home');
        }

        function irPara2Para1000() {
            if (!clienteLogado) {
                mostrarModal('<h3>Login necessário</h3><p>Faça login para jogar 2 para 1000!</p>');
                mostrarLogin();
                return;
            }
            gameMode = 'ml';
            mostrarPagina('2para1000-home');
            carregarResultadoSorteioML();
            carregarUltimosGanhadoresML();
        }

        // Funções Minhas Raspadinhas
        async function mostrarMinhasRaspadinhas() {
            if (!clienteLogado) {
                mostrarModal('<h3>Login necessário</h3><p>Faça login para ver suas raspadinhas!</p>');
                mostrarLogin();
                return;
            }
            
            mostrarPagina('minhas-raspadinhas-page');
            
            // Atualizar info do cliente
            document.getElementById('cliente-info-raspadinhas').innerHTML = `
                <h3>Olá, ${clienteLogado.nome}!</h3>
                <p>CPF: ${clienteLogado.cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.xxx.xxx-$4')}</p>
            `;
            
            // Carregar raspadinhas
            try {
                const response = await fetch('/cliente/minhas_raspadinhas');
                const data = await response.json();
                
                const container = document.getElementById('minhas-raspadinhas-container');
                
                if (data.raspadinhas && data.raspadinhas.length > 0) {
                    let html = '';
                    
                    data.raspadinhas.forEach(venda => {
                        html += `
                            <div class="raspadinha-item">
                                <h4>Compra: ${new Date(venda.data_compra).toLocaleDateString('pt-BR')}</h4>
                                <p>Payment ID: ${venda.payment_id}</p>
                                <p>Quantidade: ${venda.quantidade} raspadinhas</p>
                                <div style="margin-top: 20px;">
                        `;
                        
                        venda.raspadinhas.forEach(rasp => {
                            const statusClass = rasp.status === 'disponivel' ? 'disponivel' : 
                                               rasp.status === 'premiada' ? 'premiada' : 'raspada';
                            const statusText = rasp.status === 'disponivel' ? 'Disponível para raspar' :
                                              rasp.status === 'premiada' ? `GANHOU ${rasp.premio}!` : 'Já raspada';
                            
                            html += `
                                <div class="raspadinha-item ${statusClass}" style="margin-bottom: 15px;">
                                    <p><strong>Raspadinha #${rasp.numero}</strong></p>
                                    <p>Status: ${statusText}</p>
                                    ${rasp.status === 'disponivel' ? 
                                        `<button class="btn btn-primary" onclick="rasparMinhaRaspadinha(${rasp.id})" style="margin-top: 10px;">
                                            RASPAR AGORA
                                        </button>` : ''}
                                    ${rasp.codigo ? `<p>Código: ${rasp.codigo}</p>` : ''}
                                </div>
                            `;
                        });
                        
                        html += '</div></div>';
                    });
                    
                    container.innerHTML = html;
                } else {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 50px;">
                            <p>Você ainda não tem raspadinhas.</p>
                            <button class="btn btn-primary" onclick="irParaRaspaBrasil()" style="margin-top: 20px;">
                                COMPRAR RASPADINHAS
                            </button>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Erro ao carregar raspadinhas:', error);
                document.getElementById('minhas-raspadinhas-container').innerHTML = 
                    '<div style="text-align: center; color: #dc2626;">Erro ao carregar suas raspadinhas</div>';
            }
        }

        async function rasparMinhaRaspadinha(raspadinhaId) {
            if (!clienteLogado) {
                mostrarModal('<h3>Login necessário</h3><p>Faça login para raspar!</p>');
                mostrarLogin();
                return;
            }
            
            mostrarPagina('raspa-brasil-game');
            
            // Criar apenas uma raspadinha
            const grid = document.getElementById('raspadinha-grid-rb');
            grid.innerHTML = '';
            
            const raspadinhaContainer = document.createElement('div');
            raspadinhaContainer.className = 'raspadinha-container';
            raspadinhaContainer.innerHTML = `
                <div class="raspadinha-content">
                    <h2 class="raspadinha-titulo">Raspe a bandeira do Brasil</h2>
                    <div class="raspadinha" id="raspadinha-rb-${raspadinhaId}">
                        <div class="premio" id="premio-rb-${raspadinhaId}"></div>
                        <canvas id="scratch-rb-${raspadinhaId}"></canvas>
                    </div>
                </div>
            `;
            
            grid.appendChild(raspadinhaContainer);
            
            setTimeout(() => inicializarRaspadinhaEspecifica(raspadinhaId), 100);
        }

        function inicializarRaspadinhaEspecifica(raspadinhaId) {
            const canvas = document.getElementById(`scratch-rb-${raspadinhaId}`);
            const ctx = canvas.getContext("2d");
            const premioDiv = document.getElementById(`premio-rb-${raspadinhaId}`);

            const container = canvas.parentElement;
            canvas.width = container.offsetWidth;
            canvas.height = container.offsetHeight;

            let raspando = false;
            let premioDefinido = false;

            function desenharCapa() {
                const bandeira = new Image();
                bandeira.crossOrigin = "anonymous";
                bandeira.src = "https://pfst.cf2.poecdn.net/base/image/47394d310726277070a2b09d1da897b2a89268953e13587f3fcb468d55ca442b?w=299&h=185";
                
                bandeira.onload = () => {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    
                    const scaleX = canvas.width / bandeira.width;
                    const scaleY = canvas.height / bandeira.height;
                    const scale = Math.max(scaleX, scaleY);
                    
                    const scaledWidth = bandeira.width * scale;
                    const scaledHeight = bandeira.height * scale;
                    
                    const x = (canvas.width - scaledWidth) / 2;
                    const y = (canvas.height - scaledHeight) / 2;
                    
                    ctx.drawImage(bandeira, x, y, scaledWidth, scaledHeight);
                };
                
                bandeira.onerror = () => {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    
                    ctx.fillStyle = "#00b341";
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    
                    ctx.fillStyle = "#ffd700";
                    ctx.beginPath();
                    const centerX = canvas.width / 2;
                    const centerY = canvas.height / 2;
                    const size = Math.min(canvas.width, canvas.height) * 0.6;
                    ctx.moveTo(centerX, centerY - size/2);
                    ctx.lineTo(centerX + size/2, centerY);
                    ctx.lineTo(centerX, centerY + size/2);
                    ctx.lineTo(centerX - size/2, centerY);
                    ctx.closePath();
                    ctx.fill();
                    
                    ctx.fillStyle = "#003087";
                    ctx.beginPath();
                    ctx.arc(centerX, centerY, size/4, 0, Math.PI * 2);
                    ctx.fill();
                    
                    ctx.fillStyle = "#ffffff";
                    ctx.font = `bold ${Math.max(12, size/8)}px Arial`;
                    ctx.textAlign = "center";
                    ctx.textBaseline = "middle";
                    ctx.fillText("BRASIL", centerX, centerY);
                };
            }

            function raspar(e) {
                if (!raspando) return;
                
                if (!premioDefinido) {
                    definirPremio();
                    premioDefinido = true;
                }
                
                const rect = canvas.getBoundingClientRect();
                const x = (e.clientX || e.touches[0].clientX) - rect.left;
                const y = (e.clientY || e.touches[0].clientY) - rect.top;
                
                const scaleX = canvas.width / rect.width;
                const scaleY = canvas.height / rect.height;
                
                ctx.globalCompositeOperation = "destination-out";
                ctx.beginPath();
                ctx.arc(x * scaleX, y * scaleY, 20, 0, Math.PI * 2);
                ctx.fill();
            }

            async function definirPremio() {
                try {
                    const response = await fetch('/raspar', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ raspadinha_id: raspadinhaId })
                    });
                    
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.erro || 'Erro ao processar raspagem');
                    }
                    
                    const resultado = await response.json();
                    
                    if (resultado.ganhou) {
                        premioDiv.innerHTML = `GANHOU<br>${resultado.valor}`;
                        premioDiv.style.background = "linear-gradient(135deg, #4CAF50, #28a745)";
                        
                        setTimeout(() => {
                            mostrarFormularioPremioRB(resultado.valor, resultado.codigo);
                        }, 2000);
                    } else {
                        premioDiv.innerHTML = "Tente<br>NOVAMENTE";
                        premioDiv.style.background = "linear-gradient(135deg, #f44336, #d32f2f)";
                    }
                } catch (error) {
                    console.error('Erro ao processar prêmio:', error);
                    premioDiv.innerHTML = "Erro<br>" + error.message;
                    premioDiv.style.background = "linear-gradient(135deg, #f44336, #d32f2f)";
                }
            }

            canvas.addEventListener("mousedown", () => raspando = true);
            canvas.addEventListener("mouseup", () => raspando = false);
            canvas.addEventListener("mousemove", raspar);

            canvas.addEventListener("touchstart", (e) => {
                e.preventDefault();
                raspando = true;
            });
            canvas.addEventListener("touchend", (e) => {
                e.preventDefault();
                raspando = false;
            });
            canvas.addEventListener("touchmove", (e) => {
                e.preventDefault();
                raspar(e);
            });

            desenharCapa();
            
            const resizeObserver = new ResizeObserver(() => {
                canvas.width = container.offsetWidth;
                canvas.height = container.offsetHeight;
                desenharCapa();
            });
            resizeObserver.observe(container);
        }

        // Funções Meus Bilhetes
        async function mostrarMeusBilhetes() {
            if (!clienteLogado) {
                mostrarModal('<h3>Login necessário</h3><p>Faça login para ver seus bilhetes!</p>');
                mostrarLogin();
                return;
            }
            
            mostrarPagina('meus-bilhetes-page');
            
            // Atualizar info do cliente
            document.getElementById('cliente-info-bilhetes').innerHTML = `
                <h3>Olá, ${clienteLogado.nome}!</h3>
                <p>CPF: ${clienteLogado.cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.xxx.xxx-$4')}</p>
            `;
            
            // Carregar bilhetes
            try {
                const response = await fetch('/cliente/meus_bilhetes');
                const data = await response.json();
                
                const container = document.getElementById('meus-bilhetes-container');
                
                if (data.bilhetes && data.bilhetes.length > 0) {
                    let html = '';
                    
                    data.bilhetes.forEach(venda => {
                        html += `
                            <div class="bilhete-item">
                                <h4>Compra: ${new Date(venda.data_compra).toLocaleDateString('pt-BR')}</h4>
                                <p>Payment ID: ${venda.payment_id}</p>
                                <p>Quantidade: ${venda.quantidade} bilhete(s)</p>
                                <div style="margin-top: 20px;">
                        `;
                        
                        venda.bilhetes.forEach(bilhete => {
                            const statusText = bilhete.status === 'ativo' ? 'Aguardando sorteio' :
                                              bilhete.status === 'premiado' ? `GANHOU R$ ${bilhete.premio_ganho}!` : 'Expirado';
                            const statusClass = bilhete.status === 'premiado' ? 'premiada' : '';
                            
                            html += `
                                <div class="bilhete-item ${statusClass}" style="margin-bottom: 15px;">
                                    <div class="bilhete-numero">${bilhete.numero}</div>
                                    <p>Sorteio: ${new Date(bilhete.data_sorteio).toLocaleDateString('pt-BR')}</p>
                                    <p>Status: ${statusText}</p>
                                </div>
                            `;
                        });
                        
                        html += '</div></div>';
                    });
                    
                    container.innerHTML = html;
                } else {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 50px;">
                            <p>Você ainda não tem bilhetes.</p>
                            <button class="btn btn-primary" onclick="irPara2Para1000()" style="margin-top: 20px;">
                                COMPRAR BILHETES
                            </button>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Erro ao carregar bilhetes:', error);
                document.getElementById('meus-bilhetes-container').innerHTML = 
                    '<div style="text-align: center; color: #dc2626;">Erro ao carregar seus bilhetes</div>';
            }
        }

        // Funções Raspa Brasil
        function aumentarQuantidadeRB() {
            if (quantidadeRB < 10) {
                quantidadeRB++;
                atualizarDisplayRB();
            }
        }

        function diminuirQuantidadeRB() {
            if (quantidadeRB > 1) {
                quantidadeRB--;
                atualizarDisplayRB();
            }
        }

        function atualizarDisplayRB() {
            document.getElementById('quantidade-display-rb').textContent = quantidadeRB;
            
            let quantidadeReal = quantidadeRB;
            let valorTotal = quantidadeRB * 1.00;
            
            const promocaoDiv = document.getElementById('promocao-bonus-rb');
            
            if (quantidadeRB === 10) {
                quantidadeReal = 12;
                promocaoDiv.classList.add('ativa');
            } else {
                promocaoDiv.classList.remove('ativa');
            }
            
            document.getElementById('total-display-rb').innerHTML = `
                Total: R$ ${formatarDinheiro(valorTotal)}${quantidadeRB === 10 ? '<br><small style="color: #ff6b35;">+2 raspadinhas GRÁTIS!</small>' : ''}
            `;
        }

        function voltarRaspaBrasil() {
            mostrarPagina('raspa-brasil-home');
        }

        function irParaPagamentoRB() {
            const refCode = localStorage.getItem('raspa_ref') || sessionStorage.getItem('raspa_ref') || null;
            
            let quantidadeReal = quantidadeRB;
            if (quantidadeRB === 10) {
                quantidadeReal = 12;
            }
            
            document.getElementById('quantidade-pagamento-rb').textContent = `${quantidadeRB}${quantidadeRB === 10 ? ' (+2 grátis)' : ''}`;
            document.getElementById('total-pagamento-rb').textContent = formatarDinheiro(quantidadeRB * 1.00);
            mostrarPagina('raspa-brasil-payment');
            setTimeout(() => criarPagamentoRealRB(refCode), 1500);
        }

        function irParaRaspadinhasRB() {
            let quantidadeReal = quantidadeRB;
            if (quantidadeRB === 10) {
                quantidadeReal = 12;
            }
            
            // Mostrar Minhas Raspadinhas ao invés de gerar novas
            mostrarMinhasRaspadinhas();
        }

        async function criarPagamentoRealRB(refCode) {
            const btn = document.getElementById('btn-real-payment-rb');
            if (btn) {
                btn.innerHTML = 'Criando pagamento...';
                btn.disabled = true;
            }

            const paymentActions = document.getElementById('payment-actions-rb');
            if (paymentActions) {
                paymentActions.style.display = 'none';
            }

            try {
                const paymentData = { quantidade: quantidadeRB, game_type: 'raspa_brasil' };
                
                if (refCode && refCode.trim() !== '' && refCode !== 'null' && refCode !== 'undefined') {
                    paymentData.ref_code = refCode.trim();
                }

                const response = await fetch('/create_payment', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(paymentData)
                });

                const data = await response.json();

                if (response.ok && data.id) {
                    currentPaymentId = data.id;
                    
                    if (data.qr_code_base64) {
                        document.getElementById('qr-code-rb').innerHTML = `<img src="data:image/png;base64,${data.qr_code_base64}" alt="QR Code PIX">`;
                    }
                    if (data.qr_code) {
                        document.getElementById('pix-code-rb').textContent = data.qr_code;
                    }

                    document.getElementById('qr-section-rb').style.display = 'block';
                    document.getElementById('payment-status-rb').innerHTML = `
                        <div class="cta-message" style="background: linear-gradient(135deg, #ffc107, #ff9800);">
                            <h3>Aguardando Pagamento</h3>
                            <p style="margin: 15px 0; font-size: clamp(1em, 3.5vw, 1.2em); color: #1a1a1a; font-weight: 700;">ID: ${data.id}</p>
                        </div>
                    `;

                    iniciarVerificacaoPagamentoRB(data.id);

                } else {
                    throw new Error(data.error || 'Erro ao criar pagamento');
                }

            } catch (error) {
                console.error('Erro ao criar pagamento:', error);
                document.getElementById('payment-status-rb').innerHTML = `
                    <div class="cta-message" style="background: linear-gradient(135deg, #dc3545, #c82333);">
                        <h3>Erro ao Criar Pagamento</h3>
                        <p>${error.message}</p>
                    </div>
                `;
                
                if (paymentActions) {
                    paymentActions.style.display = 'block';
                }
                if (btn) {
                    btn.innerHTML = 'Tentar Novamente';
                    btn.disabled = false;
                }
            }
        }

        function iniciarVerificacaoPagamentoRB(paymentId) {
            if (paymentCheckInterval) {
                clearInterval(paymentCheckInterval);
            }

            let tentativas = 0;
            const maxTentativas = 120;

            paymentCheckInterval = setInterval(async () => {
                tentativas++;
                
                try {
                    const response = await fetch(`/check_payment/${paymentId}`);
                    const data = await response.json();

                    if (data.status === 'approved') {
                        clearInterval(paymentCheckInterval);
                        paymentCheckInterval = null;

                        document.getElementById('payment-status-rb').innerHTML = `
                            <div class="cta-message" style="background: linear-gradient(135deg, #28a745, #1e7e34);">
                                <h3>Pagamento Aprovado!</h3>
                                <p>Redirecionando para suas raspadinhas...</p>
                            </div>
                        `;

                        setTimeout(() => {
                            irParaRaspadinhasRB();
                        }, 3000);

                    } else if (data.status === 'rejected' || data.status === 'cancelled') {
                        clearInterval(paymentCheckInterval);
                        paymentCheckInterval = null;

                        document.getElementById('payment-status-rb').innerHTML = `
                            <div class="cta-message" style="background: linear-gradient(135deg, #dc3545, #c82333);">
                                <h3>Pagamento ${data.status === 'rejected' ? 'Rejeitado' : 'Cancelado'}</h3>
                            </div>
                        `;

                    } else if (tentativas >= maxTentativas) {
                        clearInterval(paymentCheckInterval);
                        paymentCheckInterval = null;

                        document.getElementById('payment-status-rb').innerHTML = `
                            <div class="cta-message" style="background: linear-gradient(135deg, #dc3545, #c82333);">
                                <h3>Tempo Esgotado</h3>
                            </div>
                        `;
                    }

                } catch (error) {
                    console.error('Erro ao verificar pagamento:', error);
                    
                    if (tentativas >= maxTentativas) {
                        clearInterval(paymentCheckInterval);
                        paymentCheckInterval = null;
                    }
                }
            }, 5000);
        }

        function copiarCodigoPixRB() {
            const codigo = document.getElementById('pix-code-rb').textContent;
            navigator.clipboard.writeText(codigo).then(() => {
                const btn = event.target;
                const originalText = btn.innerHTML;
                btn.innerHTML = 'Copiado!';
                btn.style.background = 'linear-gradient(135deg, #28a745, #20c997)';
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.style.background = '';
                }, 3000);
            }).catch(() => {
                mostrarModal('Código PIX copiado!');
            });
        }

        function mostrarFormularioPremioRB(valor, codigo) {
            const container = document.getElementById('premio-container-rb');
            container.innerHTML = `
                <div class="bilhete-container">
                    <h3>PARABÉNS! VOCÊ GANHOU ${valor}!</h3>
                    <p style="text-align: center; font-size: clamp(1em, 4vw, 1.2em); margin-bottom: 30px; font-weight: 600;">
                        Preencha seus dados para receber o prêmio em até 24 horas:
                    </p>
                    
                    <div class="form-group">
                        <label>Nome Completo:</label>
                        <input type="text" id="nome-ganhador-rb" placeholder="Digite seu nome completo" required>
                    </div>
                    
                    <div class="form-group">
                        <label>Tipo de Chave PIX:</label>
                        <select id="tipo-chave-rb">
                            <option value="cpf">CPF</option>
                            <option value="email">E-mail</option>
                            <option value="telefone">Telefone</option>
                            <option value="aleatoria">Chave Aleatória</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Chave PIX:</label>
                        <input type="text" id="chave-pix-rb" placeholder="Digite sua chave PIX" required>
                    </div>
                    
                    <div class="form-group">
                        <label>Código de Validação:</label>
                        <input type="text" id="codigo-antifraude-rb" value="${codigo}" readonly style="background: #f8f9fa; font-weight: 700; color: #00b341;">
                    </div>
                    
                    <button class="whatsapp-btn" onclick="enviarWhatsAppRB('${valor}', '${codigo}')">
                        Enviar dados via WhatsApp
                    </button>
                </div>
            `;
            container.style.display = 'block';
            container.scrollIntoView({ behavior: 'smooth' });
        }

        async function enviarWhatsAppRB(valor, codigo) {
            const nome = document.getElementById('nome-ganhador-rb').value.trim();
            const tipoChave = document.getElementById('tipo-chave-rb').value;
            const chavePix = document.getElementById('chave-pix-rb').value.trim();
            
            if (!nome || !chavePix) {
                mostrarModal('<h3>Atenção</h3><p>Por favor, preencha todos os campos!</p>');
                return;
            }

            if (nome.length < 3 || chavePix.length < 5) {
                mostrarModal('<h3>Atenção</h3><p>Dados inválidos!</p>');
                return;
            }
            
            try {
                const response = await fetch('/salvar_ganhador', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        nome, valor, chave_pix: chavePix, tipo_chave: tipoChave, codigo
                    })
                });

                const resultado = await response.json();
                
                if (resultado.sucesso) {
                    const mensagem = `GANHEI NO RASPA BRASIL!

DADOS DO GANHADOR:
• Nome: ${nome}
• Prêmio: ${valor}
• Tipo de chave: ${tipoChave}
• Chave PIX: ${chavePix}
• Código de validação: ${codigo}

Solicito o pagamento do meu prêmio!`;
                    
                    const whatsappUrl = `https://wa.me/${WHATSAPP_NUMERO}?text=${encodeURIComponent(mensagem)}`;
                    window.open(whatsappUrl, '_blank');
                    
                    mostrarModal(`
                        <h3>Dados Enviados!</h3>
                        <p>Código: <strong>${codigo}</strong></p>
                        <p>Prazo: até 24 horas</p>
                    `);
                } else {
                    mostrarModal(`<h3>Erro</h3><p>${resultado.erro}</p>`);
                }
                
            } catch (error) {
                console.error('Erro ao salvar ganhador:', error);
                mostrarModal('<h3>Erro</h3><p>Tente novamente</p>');
            }
        }

        // Funções 2 para 1000
        function aumentarQuantidadeML() {
            quantidadeML++;
            atualizarDisplayML();
        }

        function diminuirQuantidadeML() {
            if (quantidadeML > 1) {
                quantidadeML--;
                atualizarDisplayML();
            }
        }

        function atualizarDisplayML() {
            document.getElementById('quantidade-display-ml').textContent = quantidadeML;
            const valorTotal = quantidadeML * 2.00;
            document.getElementById('total-display-ml').innerHTML = `Total: R$ ${formatarDinheiro(valorTotal)}`;
        }

        function voltar2Para1000() {
            mostrarPagina('2para1000-home');
        }

        function irParaPagamentoML() {
            document.getElementById('quantidade-pagamento-ml').textContent = quantidadeML;
            document.getElementById('total-pagamento-ml').textContent = formatarDinheiro(quantidadeML * 2.00);
            mostrarPagina('2para1000-payment');
            setTimeout(() => criarPagamentoRealML(), 1500);
        }

        function irParaBilhetesML() {
            document.getElementById('quantidade-bilhetes-ml').textContent = quantidadeML;
            mostrarPagina('2para1000-bilhetes');
            gerarBilhetesML();
        }

        async function criarPagamentoRealML() {
            const btn = document.getElementById('btn-real-payment-ml');
            if (btn) {
                btn.innerHTML = 'Criando pagamento...';
                btn.disabled = true;
            }

            const paymentActions = document.getElementById('payment-actions-ml');
            if (paymentActions) {
                paymentActions.style.display = 'none';
            }

            try {
                const response = await fetch('/create_payment', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ quantidade: quantidadeML, game_type: '2para1000' })
                });

                const data = await response.json();

                if (response.ok && data.id) {
                    currentPaymentId = data.id;
                    
                    if (data.qr_code_base64) {
                        document.getElementById('qr-code-ml').innerHTML = `<img src="data:image/png;base64,${data.qr_code_base64}" alt="QR Code PIX">`;
                    }
                    if (data.qr_code) {
                        document.getElementById('pix-code-ml').textContent = data.qr_code;
                    }

                    document.getElementById('qr-section-ml').style.display = 'block';
                    document.getElementById('payment-status-ml').innerHTML = `
                        <div class="cta-message" style="background: linear-gradient(135deg, #ffc107, #ff9800);">
                            <h3>Aguardando Pagamento</h3>
                            <p style="margin: 15px 0; font-size: clamp(1em, 3.5vw, 1.2em); color: #1a1a1a; font-weight: 700;">ID: ${data.id}</p>
                        </div>
                    `;

                    iniciarVerificacaoPagamentoML(data.id);

                } else {
                    throw new Error(data.error || 'Erro ao criar pagamento');
                }

            } catch (error) {
                console.error('Erro ao criar pagamento:', error);
                document.getElementById('payment-status-ml').innerHTML = `
                    <div class="cta-message" style="background: linear-gradient(135deg, #dc3545, #c82333);">
                        <h3>Erro ao Criar Pagamento</h3>
                        <p>${error.message}</p>
                    </div>
                `;
                
                if (paymentActions) {
                    paymentActions.style.display = 'block';
                }
                if (btn) {
                    btn.innerHTML = 'Tentar Novamente';
                    btn.disabled = false;
                }
            }
        }

        function iniciarVerificacaoPagamentoML(paymentId) {
            if (paymentCheckInterval) {
                clearInterval(paymentCheckInterval);
            }

            let tentativas = 0;
            const maxTentativas = 120;

            paymentCheckInterval = setInterval(async () => {
                tentativas++;
                
                try {
                    const response = await fetch(`/check_payment/${paymentId}`);
                    const data = await response.json();

                    if (data.status === 'approved') {
                        clearInterval(paymentCheckInterval);
                        paymentCheckInterval = null;

                        document.getElementById('payment-status-ml').innerHTML = `
                            <div class="cta-message" style="background: linear-gradient(135deg, #28a745, #1e7e34);">
                                <h3>Pagamento Aprovado!</h3>
                                <p>Gerando seus bilhetes...</p>
                            </div>
                        `;

                        setTimeout(() => {
                            irParaBilhetesML();
                        }, 3000);

                    } else if (data.status === 'rejected' || data.status === 'cancelled') {
                        clearInterval(paymentCheckInterval);
                        paymentCheckInterval = null;

                        document.getElementById('payment-status-ml').innerHTML = `
                            <div class="cta-message" style="background: linear-gradient(135deg, #dc3545, #c82333);">
                                <h3>Pagamento ${data.status === 'rejected' ? 'Rejeitado' : 'Cancelado'}</h3>
                            </div>
                        `;

                    } else if (tentativas >= maxTentativas) {
                        clearInterval(paymentCheckInterval);
                        paymentCheckInterval = null;

                        document.getElementById('payment-status-ml').innerHTML = `
                            <div class="cta-message" style="background: linear-gradient(135deg, #dc3545, #c82333);">
                                <h3>Tempo Esgotado</h3>
                            </div>
                        `;
                    }

                } catch (error) {
                    console.error('Erro ao verificar pagamento:', error);
                    
                    if (tentativas >= maxTentativas) {
                        clearInterval(paymentCheckInterval);
                        paymentCheckInterval = null;
                    }
                }
            }, 5000);
        }

        function copiarCodigoPixML() {
            const codigo = document.getElementById('pix-code-ml').textContent;
            navigator.clipboard.writeText(codigo).then(() => {
                const btn = event.target;
                const originalText = btn.innerHTML;
                btn.innerHTML = 'Copiado!';
                btn.style.background = 'linear-gradient(135deg, #28a745, #20c997)';
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.style.background = '';
                }, 3000);
            }).catch(() => {
                mostrarModal('Código PIX copiado!');
            });
        }

        async function gerarBilhetesML() {
            try {
                const response = await fetch('/gerar_bilhetes_ml', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });
                
                const resultado = await response.json();
                
                if (resultado.sucesso) {
                    const container = document.getElementById('bilhetes-container-ml');
                    container.innerHTML = '';
                    
                    resultado.bilhetes.forEach((numero, index) => {
                        const bilheteDiv = document.createElement('div');
                        bilheteDiv.className = 'bilhete-container';
                        bilheteDiv.innerHTML = `
                            <h3 style="color: #4CAF50; font-size: clamp(1.5em, 5vw, 2em); margin-bottom: 20px; text-align: center; font-weight: 800;">
                                Bilhete ${index + 1}
                            </h3>
                            <div class="bilhete-digital">
                                <div style="text-align: center; margin-bottom: 20px;">
                                    <h4 style="color: #666; margin-bottom: 10px;">SEU NÚMERO DA SORTE</h4>
                                    <div class="bilhete-numero">${numero}</div>
                                    <p style="color: #666; font-weight: 600; margin-top: 10px;">
                                        Sorteio diário às 18h baseado na Lotep/PB
                                    </p>
                                </div>
                                
                                <div style="border-top: 2px dashed #ccc; padding-top: 20px;">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; text-align: center;">
                                        <div>
                                            <strong>Data:</strong><br>
                                            ${obterDataHoraBrasilia().toLocaleDateString('pt-BR')}
                                        </div>
                                        <div>
                                            <strong>Valor:</strong><br>
                                            R$ 2,00
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
                        
                        container.appendChild(bilheteDiv);
                    });
                }
            } catch (error) {
                console.error('Erro ao gerar bilhetes:', error);
                mostrarModal('<h3>Erro</h3><p>Erro ao gerar bilhetes. Tente novamente.</p>');
            }
        }

        async function enviarBilheteML() {
            const nome = document.getElementById('nome-cliente-ml').value.trim();
            const telefone = document.getElementById('telefone-cliente-ml').value.trim();
            const chavePix = document.getElementById('chave-pix-cliente-ml').value.trim();
            
            if (!nome || !telefone || !chavePix) {
                mostrarModal('<h3>Atenção</h3><p>Por favor, preencha todos os campos!</p>');
                return;
            }

            if (nome.length < 3) {
                mostrarModal('<h3>Atenção</h3><p>Nome deve ter pelo menos 3 caracteres!</p>');
                return;
            }

            try {
                const response = await fetch('/enviar_bilhete', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        nome, telefone, chave_pix: chavePix, payment_id: currentPaymentId
                    })
                });

                const resultado = await response.json();
                
                if (resultado.sucesso) {
                    mostrarModal(`
                        <h3>Bilhete Enviado!</h3>
                        <p>Seus bilhetes foram registrados!</p>
                        <p>Sorteio: Hoje às 18h</p>
                        <p>Boa sorte!</p>
                    `);
                    
                    document.getElementById('formulario-dados-ml').style.display = 'none';
                } else {
                    mostrarModal(`<h3>Erro</h3><p>${resultado.erro}</p>`);
                }

            } catch (error) {
                console.error('Erro ao enviar bilhete:', error);
                mostrarModal('<h3>Erro</h3><p>Erro ao enviar bilhete. Tente novamente.</p>');
            }
        }

        async function carregarResultadoSorteioML() {
            try {
                const response = await fetch('/resultado_sorteio');
                const resultado = await response.json();
                
                if (resultado.milhar_sorteada) {
                    document.getElementById('milhar-sorteada-ml').textContent = resultado.milhar_sorteada;
                    
                    if (resultado.houve_ganhador) {
                        document.getElementById('status-sorteio-ml').innerHTML = `
                            <div style="background: #d4edda; color: #155724; padding: 20px; border-radius: 15px; text-align: center; margin: 20px 0; border: 3px solid #c3e6cb;">
                                <h3>TIVEMOS UM GANHADOR!</h3>
                                <p style="font-size: 1.2em; margin: 10px 0;">
                                    O bilhete com a milhar <strong>${resultado.milhar_sorteada}</strong> ganhou <strong>${resultado.valor_premio}</strong>!
                                </p>
                                <p>Próximo sorteio hoje às 18h!</p>
                            </div>
                        `;
                        document.getElementById('premio-acumulado-valor-ml').textContent = 'R$ 1.000,00';
                    } else {
                        document.getElementById('status-sorteio-ml').innerHTML = `
                            <div style="background: #fff3cd; color: #856404; padding: 20px; border-radius: 15px; text-align: center; margin: 20px 0; border: 3px solid #ffeaa7;">
                                <h3>Nenhum ganhador hoje!</h3>
                                <p style="font-size: 1.2em; margin: 10px 0;">
                                    Milhar sorteada: <strong>${resultado.milhar_sorteada}</strong>
                                </p>
                                <p>O prêmio acumulou para o próximo sorteio!</p>
                            </div>
                        `;
                        document.getElementById('premio-acumulado-valor-ml').textContent = `R$ ${resultado.valor_acumulado}`;
                    }
                } else {
                    document.getElementById('milhar-sorteada-ml').textContent = '----';
                    document.getElementById('status-sorteio-ml').innerHTML = `
                        <p style="text-align: center; font-size: clamp(1.2em, 4vw, 1.5em); font-weight: 600; margin: 20px 0;">
                            Aguardando sorteio das 18h...
                        </p>
                    `;
                    document.getElementById('premio-acumulado-valor-ml').textContent = `R$ ${resultado.valor_acumulado || '1.000,00'}`;
                }
                
            } catch (error) {
                console.error('Erro ao carregar resultado:', error);
            }
        }

        async function carregarUltimosGanhadoresML() {
            try {
                const response = await fetch('/ultimos_ganhadores');
                const resultado = await response.json();
                
                if (resultado.ganhadores && resultado.ganhadores.length > 0) {
                    let html = `
                        <div style="background: linear-gradient(135deg, #f0f9f0, #e8f5e8); padding: 25px; border-radius: 20px; margin: 40px 0; box-shadow: 0 8px 40px rgba(0, 0, 0, 0.15); border: 3px solid #28a745;">
                            <h3 style="text-align: center; margin-bottom: 30px; font-size: clamp(1.8em, 6vw, 2.5em); color: #28a745; font-weight: 800;">
                                Últimos Ganhadores
                            </h3>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                    `;
                    
                    resultado.ganhadores.forEach(ganhador => {
                        html += `
                            <div style="background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1); text-align: center; border: 2px solid #28a745;">
                                <div style="font-size: 1.3em; font-weight: 800; color: #1a1a1a; margin-bottom: 8px;">
                                    ${ganhador.nome}
                                </div>
                                <div style="font-size: 1.6em; font-weight: 900; color: #28a745; margin-bottom: 8px;">
                                    ${ganhador.valor}
                                </div>
                                <div style="font-size: 1em; color: #666; font-weight: 600;">
                                    Milhar: ${ganhador.milhar}
                                </div>
                                <div style="font-size: 0.9em; color: #666; font-weight: 600;">
                                    ${ganhador.data}
                                </div>
                            </div>
                        `;
                    });
                    
                    html += '</div></div>';
                    document.getElementById('ultimos-ganhadores-ml').innerHTML = html;
                }
            } catch (error) {
                console.error('Erro ao carregar ganhadores:', error);
            }
        }

        // Funções de Afiliados
        function abrirAfiliados() {
            mostrarPagina('affiliate-page');
            if (currentAffiliate) {
                exibirDashboardAfiliado();
            } else {
                document.getElementById('affiliate-signup').style.display = 'block';
                document.getElementById('affiliate-login').style.display = 'none';
                document.getElementById('affiliate-dashboard').style.display = 'none';
            }
        }

        function mostrarLoginAfiliado() {
            document.getElementById('affiliate-signup').style.display = 'none';
            document.getElementById('affiliate-login').style.display = 'block';
            document.getElementById('affiliate-dashboard').style.display = 'none';
        }

        function voltarCadastroAfiliado() {
            document.getElementById('affiliate-signup').style.display = 'block';
            document.getElementById('affiliate-login').style.display = 'none';
            document.getElementById('affiliate-dashboard').style.display = 'none';
        }

        async function cadastrarAfiliado() {
            const nome = document.getElementById('affiliate-nome').value.trim();
            const telefone = document.getElementById('affiliate-telefone').value.trim();
            const email = document.getElementById('affiliate-email').value.trim();
            const cpf = document.getElementById('affiliate-cpf').value.trim();

            console.log('Dados do formulário:', { nome, telefone, email, cpf });

            if (!nome || !telefone || !email || !cpf) {
                mostrarModal('<h3>Atenção</h3><p>Por favor, preencha todos os campos!</p>');
                return;
            }

            // Validações mais flexíveis
            if (nome.length < 2) {
                mostrarModal('<h3>Atenção</h3><p>Nome deve ter pelo menos 2 caracteres!</p>');
                return;
            }

            if (!email.includes('@') || email.length < 5) {
                mostrarModal('<h3>Atenção</h3><p>Digite um email válido!</p>');
                return;
            }

            const cpfLimpo = cpf.replace(/\D/g, '');
            if (cpfLimpo.length !== 11) {
                mostrarModal('<h3>Atenção</h3><p>CPF deve ter 11 dígitos!</p>');
                return;
            }

            if (telefone.length < 10) {
                mostrarModal('<h3>Atenção</h3><p>Telefone deve ter pelo menos 10 dígitos!</p>');
                return;
            }

            try {
                console.log('Enviando dados para o servidor...');
                
                const response = await fetch('/cadastrar_afiliado', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        nome: nome, 
                        telefone: telefone, 
                        email: email.toLowerCase(), 
                        cpf: cpfLimpo 
                    })
                });

                console.log('Status da resposta:', response.status);
                
                if (!response.ok) {
                    throw new Error(`Erro HTTP: ${response.status}`);
                }

                const resultado = await response.json();
                console.log('Resultado do servidor:', resultado);
                
                if (resultado.sucesso) {
                    currentAffiliate = resultado.afiliado;
                    localStorage.setItem('affiliate_cpf', cpfLimpo);
                    
                    exibirDashboardAfiliado();
                    mostrarModal(`
                        <h3>Cadastro Realizado!</h3>
                        <p>Bem-vindo ao programa de afiliados!</p>
                        <p><strong>Seu código:</strong> ${resultado.afiliado.codigo}</p>
                    `);
                } else {
                    console.error('Erro retornado pelo servidor:', resultado.erro);
                    mostrarModal(`<h3>Erro</h3><p>${resultado.erro || 'Erro desconhecido'}</p>`);
                }

            } catch (error) {
                console.error('Erro ao cadastrar afiliado:', error);
                mostrarModal('<h3>Erro</h3><p>Erro de conexão. Verifique sua internet e tente novamente.</p>');
            }
        }

        async function loginAfiliado() {
            const cpf = document.getElementById('login-affiliate-cpf').value.replace(/\D/g, '');
            const messageDiv = document.getElementById('login-affiliate-message');
            
            if (!cpf || cpf.length !== 11) {
                messageDiv.innerHTML = '<div style="color: #dc2626; padding: 10px; background: #fee; border-radius: 8px;">Digite um CPF válido</div>';
                return;
            }
            
            try {
                const response = await fetch('/login_afiliado', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ cpf })
                });

                const resultado = await response.json();
                
                if (resultado.sucesso) {
                    currentAffiliate = resultado.afiliado;
                    localStorage.setItem('affiliate_cpf', cpf);
                    
                    exibirDashboardAfiliado();
                    messageDiv.innerHTML = '<div style="color: #155724; padding: 10px; background: #d4edda; border-radius: 8px;">Login realizado com sucesso!</div>';
                } else {
                    messageDiv.innerHTML = `<div style="color: #dc2626; padding: 10px; background: #fee; border-radius: 8px;">${resultado.erro}</div>`;
                }
                
            } catch (error) {
                console.error('Erro no login afiliado:', error);
                messageDiv.innerHTML = '<div style="color: #dc2626; padding: 10px; background: #fee; border-radius: 8px;">Erro ao fazer login. Tente novamente.</div>';
            }
        }

        function exibirDashboardAfiliado() {
            document.getElementById('affiliate-signup').style.display = 'none';
            document.getElementById('affiliate-login').style.display = 'none';
            document.getElementById('affiliate-dashboard').style.display = 'block';
            
            document.getElementById('affiliate-name-display').textContent = currentAffiliate.nome;
            document.getElementById('affiliate-link-display').textContent = `${window.location.origin}/?ref=${currentAffiliate.codigo}`;
            document.getElementById('affiliate-clicks').textContent = currentAffiliate.total_clicks || 0;
            document.getElementById('affiliate-sales').textContent = currentAffiliate.total_vendas || 0;
            document.getElementById('affiliate-commission').textContent = `R$ ${formatarDinheiro(currentAffiliate.total_comissao || 0)}`;
            document.getElementById('affiliate-balance').textContent = `R$ ${formatarDinheiro(currentAffiliate.saldo_disponivel || 0)}`;
            
            if (currentAffiliate.chave_pix) {
                document.getElementById('affiliate-pix-type').value = currentAffiliate.tipo_chave_pix || 'cpf';
                document.getElementById('affiliate-pix-key').value = currentAffiliate.chave_pix;
            }
            
            atualizarBotaoSaque();
        }

        function logoutAfiliado() {
            currentAffiliate = null;
            localStorage.removeItem('affiliate_cpf');
            voltarCadastroAfiliado();
        }

        function copiarLinkAfiliado() {
            const link = document.getElementById('affiliate-link-display').textContent;
            navigator.clipboard.writeText(link).then(() => {
                mostrarModal('<h3>Link Copiado!</h3><p>Seu link de afiliado foi copiado!</p>');
            }).catch(() => {
                mostrarModal('<h3>Link copiado!</h3><p>Compartilhe e comece a ganhar!</p>');
            });
        }

        async function salvarChavePix() {
            const tipo = document.getElementById('affiliate-pix-type').value;
            const chave = document.getElementById('affiliate-pix-key').value.trim();
            
            if (!chave || chave.length < 5) {
                mostrarModal('<h3>Atenção</h3><p>Digite uma chave PIX válida!</p>');
                return;
            }
            
            try {
                const response = await fetch('/atualizar_pix_afiliado', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        codigo: currentAffiliate.codigo,
                        chave_pix: chave,
                        tipo_chave: tipo
                    })
                });

                const resultado = await response.json();
                
                if (resultado.sucesso) {
                    currentAffiliate.chave_pix = chave;
                    currentAffiliate.tipo_chave_pix = tipo;
                    atualizarBotaoSaque();
                    mostrarModal('<h3>Chave PIX Salva!</h3><p>Agora você pode solicitar saques.</p>');
                } else {
                    mostrarModal('<h3>Erro</h3><p>Erro ao salvar chave PIX</p>');
                }
            } catch (error) {
                console.error('Erro ao salvar PIX:', error);
                mostrarModal('<h3>Erro</h3><p>Erro ao salvar chave PIX</p>');
            }
        }

        function atualizarBotaoSaque() {
            const btnSaque = document.getElementById('btn-saque');
            if ((currentAffiliate.saldo_disponivel || 0) >= 10 && currentAffiliate.chave_pix) {
                btnSaque.disabled = false;
            } else {
                btnSaque.disabled = true;
            }
        }

        async function solicitarSaque() {
            if ((currentAffiliate.saldo_disponivel || 0) < 10) {
                mostrarModal('<h3>Saldo Insuficiente</h3><p>Saldo mínimo para saque: R$ 10,00</p>');
                return;
            }
            
            if (!currentAffiliate.chave_pix) {
                mostrarModal('<h3>Atenção</h3><p>Configure sua chave PIX primeiro!</p>');
                return;
            }
            
            try {
                const response = await fetch('/solicitar_saque_afiliado', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ codigo: currentAffiliate.codigo })
                });

                const resultado = await response.json();
                
                if (resultado.sucesso) {
                    currentAffiliate.saldo_disponivel = 0;
                    document.getElementById('affiliate-balance').textContent = 'R$ 0,00';
                    atualizarBotaoSaque();
                    
                    mostrarModal(`
                        <h3>Saque Solicitado!</h3>
                        <p>Valor: R$ ${formatarDinheiro(resultado.valor)}</p>
                        <p>Processamento: até 24 horas</p>
                    `);
                } else {
                    mostrarModal(`<h3>Erro</h3><p>${resultado.erro}</p>`);
                }
            } catch (error) {
                console.error('Erro ao solicitar saque:', error);
                mostrarModal('<h3>Erro</h3><p>Erro ao solicitar saque</p>');
            }
        }

        // Admin functions
        function abrirAdmin() {
            document.getElementById('admin-modal').style.display = 'flex';
        }

        function fecharAdmin() {
            document.getElementById('admin-modal').style.display = 'none';
        }

        function trocarAbaAdmin(aba) {
            // Remove active de todas as abas
            document.querySelectorAll('.admin-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.admin-tab-content').forEach(content => content.classList.remove('active'));
            
            // Adiciona active na aba clicada
            event.target.classList.add('active');
            
            // Mostra o conteúdo correspondente
            const targetContent = document.getElementById(`admin-${aba}`);
            if (targetContent) {
                targetContent.classList.add('active');
            }
            
            currentAdminTab = aba;
            
            // Carregar dados específicos da aba
            if (aba === 'controle-premios') {
                verificarStatusPremioPendente();
            } else if (aba === 'sorteio-ml') {
                carregarStatusSorteio();
            } else if (aba === 'afiliados') {
                carregarDadosAfiliados();
            } else if (aba === 'saques') {
                carregarSaques('todos');
            } else if (aba === 'bilhetes') {
                carregarBilhetesHoje();
            } else if (aba === 'raspadinhas') {
                carregarRaspadinhasHoje();
            } else if (aba === 'ganhadores') {
                carregarGanhadores('todos');
            } else if (aba === 'vendas') {
                carregarRelatorioVendas();
            } else if (aba === 'dashboard') {
                carregarEstatisticasAdmin();
            }
        }

        async function loginAdmin() {
            const senha = document.getElementById('admin-senha').value;
            const messageDiv = document.getElementById('admin-message');
            
            if (!senha) {
                messageDiv.innerHTML = '<div style="color: #dc2626; padding: 10px; background: #fee; border-radius: 8px;">Digite a senha</div>';
                return;
            }
            
            try {
                const response = await fetch('/admin/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ senha })
                });
                
                const resultado = await response.json();
                
                if (resultado.success) {
                    document.getElementById('admin-login').style.display = 'none';
                    document.getElementById('admin-panel').style.display = 'block';
                    messageDiv.innerHTML = '<div style="color: #155724; padding: 10px; background: #d4edda; border-radius: 8px;">Login realizado com sucesso!</div>';
                    await carregarEstatisticasAdmin();
                } else {
                    messageDiv.innerHTML = '<div style="color: #dc2626; padding: 10px; background: #fee; border-radius: 8px;">Senha incorreta</div>';
                }
                
            } catch (error) {
                console.error('Erro no login admin:', error);
                messageDiv.innerHTML = '<div style="color: #dc2626; padding: 10px; background: #fee; border-radius: 8px;">Erro ao fazer login</div>';
            }
        }

        async function carregarEstatisticasAdmin() {
            try {
                const response = await fetch('/admin/stats?game=both');
                const stats = await response.json();
                
                document.getElementById('admin-vendidas-rb').textContent = stats.vendidas || 0;
                document.getElementById('admin-vendidos-ml').textContent = stats.bilhetes_vendidos || 0;
                document.getElementById('admin-ganhadores-total').textContent = (stats.ganhadores || 0) + (stats.total_ganhadores || 0);
                document.getElementById('admin-afiliados').textContent = stats.afiliados || 0;
                document.getElementById('admin-clientes').textContent = stats.total_clientes || 0;
                
                // Dashboard extras
                if (document.getElementById('admin-sistema-status')) {
                    document.getElementById('admin-sistema-status').textContent = stats.sistema_ativo ? 'ATIVO' : 'INATIVO';
                    document.getElementById('admin-sistema-status').style.color = stats.sistema_ativo ? '#28a745' : '#dc2626';
                }
                
                if (document.getElementById('admin-premio-acumulado')) {
                    document.getElementById('admin-premio-acumulado').textContent = `R$ ${stats.premio_atual || '1.000,00'}`;
                }
                
                if (document.getElementById('admin-vendas-hoje')) {
                    document.getElementById('admin-vendas-hoje').textContent = (stats.vendas_hoje || 0) + (stats.vendas_hoje_ml || 0);
                }
                
            } catch (error) {
                console.error('Erro ao carregar estatísticas:', error);
            }
        }

        // Funções específicas do Raspa Brasil Admin
        async function verificarStatusPremioPendente() {
            try {
                const response = await fetch('/admin/verificar_status_premio');
                const resultado = await response.json();
                
                const statusElement = document.getElementById('admin-premio-liberado-status');
                if (statusElement) {
                    if (resultado.premio_liberado) {
                        statusElement.textContent = resultado.valor;
                        statusElement.style.background = '#d4edda';
                        statusElement.style.color = '#155724';
                    } else {
                        statusElement.textContent = 'NENHUM';
                        statusElement.style.background = '#f8d7da';
                        statusElement.style.color = '#721c24';
                    }
                }
                
                const btnLiberar = document.getElementById('btn-liberar-premio');
                if (btnLiberar) {
                    btnLiberar.disabled = resultado.premio_liberado;
                    btnLiberar.textContent = resultado.premio_liberado ? 'PRÊMIO JÁ LIBERADO' : 'LIBERAR PRÊMIO';
                }
                
            } catch (error) {
                console.error('Erro ao verificar status do prêmio:', error);
            }
        }

        async function liberarPremioManual() {
            const valor = document.getElementById('admin-valor-premio').value;
            const messageDiv = document.getElementById('admin-premio-message');
            const btnLiberar = document.getElementById('btn-liberar-premio');
            
            if (!valor) {
                messageDiv.innerHTML = '<div style="color: #dc2626; padding: 15px; background: #fee; border-radius: 8px; font-weight: 600;">Selecione um valor para o prêmio!</div>';
                return;
            }
            
            btnLiberar.disabled = true;
            btnLiberar.textContent = 'LIBERANDO...';
            
            try {
                const response = await fetch('/admin/liberar_premio_manual', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ valor })
                });
                
                const resultado = await response.json();
                
                if (resultado.sucesso) {
                    messageDiv.innerHTML = `
                        <div style="color: #155724; padding: 15px; background: #d4edda; border-radius: 8px; font-weight: 600;">
                            ✅ Prêmio ${valor} liberado com sucesso!<br>
                            <small>Será entregue na próxima raspagem.</small>
                        </div>
                    `;
                    
                    document.getElementById('admin-valor-premio').value = '';
                    verificarStatusPremioPendente();
                    
                } else {
                    messageDiv.innerHTML = `<div style="color: #dc2626; padding: 15px; background: #fee; border-radius: 8px; font-weight: 600;">❌ ${resultado.erro}</div>`;
                    btnLiberar.disabled = false;
                    btnLiberar.textContent = 'LIBERAR PRÊMIO';
                }
                
            } catch (error) {
                console.error('Erro ao liberar prêmio:', error);
                messageDiv.innerHTML = '<div style="color: #dc2626; padding: 15px; background: #fee; border-radius: 8px; font-weight: 600;">❌ Erro ao liberar prêmio</div>';
                btnLiberar.disabled = false;
                btnLiberar.textContent = 'LIBERAR PRÊMIO';
            }
        }

        // Funções específicas do 2 para 1000 Admin
        async function carregarStatusSorteio() {
            try {
                const response = await fetch('/resultado_sorteio');
                const resultado = await response.json();
                
                if (document.getElementById('admin-milhar-hoje')) {
                    document.getElementById('admin-milhar-hoje').textContent = resultado.milhar_sorteada || '----';
                }
                
                if (document.getElementById('admin-status-ganhador')) {
                    const statusElement = document.getElementById('admin-status-ganhador');
                    if (resultado.milhar_sorteada) {
                        if (resultado.houve_ganhador) {
                            statusElement.textContent = 'HOUVE GANHADOR!';
                            statusElement.style.color = '#28a745';
                        } else {
                            statusElement.textContent = 'SEM GANHADOR';
                            statusElement.style.color = '#dc2626';
                        }
                    } else {
                        statusElement.textContent = 'Aguardando';
                        statusElement.style.color = '#6c757d';
                    }
                }
                
                if (document.getElementById('admin-premio-atual')) {
                    document.getElementById('admin-premio-atual').textContent = `R$ ${resultado.valor_acumulado || '1.000,00'}`;
                }
                
                // Verificar se já foi sorteado hoje
                const btnSortear = document.getElementById('btn-sortear');
                if (btnSortear) {
                    if (resultado.milhar_sorteada) {
                        btnSortear.disabled = true;
                        btnSortear.textContent = 'SORTEIO JÁ REALIZADO HOJE';
                        document.getElementById('admin-milhar-sorteada').disabled = true;
                    } else {
                        btnSortear.disabled = false;
                        btnSortear.textContent = 'REALIZAR SORTEIO';
                        document.getElementById('admin-milhar-sorteada').disabled = false;
                    }
                }
                
                // Carregar participantes de hoje
                await carregarParticipantesHoje();
                
            } catch (error) {
                console.error('Erro ao carregar status do sorteio:', error);
            }
        }

        async function carregarParticipantesHoje() {
            try {
                const hoje = obterDataHoraBrasilia().toISOString().split('T')[0];
                const response = await fetch(`/admin/bilhetes/${hoje}`);
                const resultado = await response.json();
                
                if (document.getElementById('admin-participantes-hoje')) {
                    const totalBilhetes = (resultado.bilhetes || []).reduce((sum, bilhete) => {
                        return sum + (bilhete.bilhetes ? bilhete.bilhetes.length : 0);
                    }, 0);
                    document.getElementById('admin-participantes-hoje').textContent = totalBilhetes;
                }
            } catch (error) {
                console.error('Erro ao carregar participantes:', error);
            }
        }

        async function editarPremioML() {
            const novoValor = document.getElementById('admin-novo-premio-ml').value.trim();
            
            if (!novoValor) {
                mostrarModal('<h3>Atenção</h3><p>Digite o novo valor do prêmio!</p>');
                return;
            }
            
            try {
                const response = await fetch('/admin/editar_premio_ml', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ valor: novoValor })
                });
                
                const resultado = await response.json();
                
                if (resultado.sucesso) {
                    document.getElementById('admin-premio-atual').textContent = resultado.novo_valor;
                    document.getElementById('admin-novo-premio-ml').value = '';
                    mostrarModal(`<h3>Sucesso!</h3><p>Prêmio atualizado para ${resultado.novo_valor}</p>`);
                } else {
                    mostrarModal(`<h3>Erro</h3><p>${resultado.erro}</p>`);
                }
            } catch (error) {
                console.error('Erro ao editar prêmio:', error);
                mostrarModal('<h3>Erro</h3><p>Erro ao atualizar prêmio</p>');
            }
        }

        async function realizarSorteio() {
            const milhar = document.getElementById('admin-milhar-sorteada').value.trim();
            const messageDiv = document.getElementById('admin-sorteio-message');
            const btnSortear = document.getElementById('btn-sortear');
            
            if (!milhar || milhar.length !== 4 || !milhar.match(/^\d{4}$/)) {
                messageDiv.innerHTML = '<div style="color: #dc2626; padding: 15px; background: #fee; border-radius: 8px; font-weight: 600;">Digite exatamente 4 números!</div>';
                return;
            }
            
            btnSortear.disabled = true;
            btnSortear.textContent = 'PROCESSANDO...';
            
            try {
                const response = await fetch('/admin/sortear', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ milhar_sorteada: milhar })
                });
                
                const resultado = await response.json();
                
                if (resultado.sucesso) {
                    if (resultado.houve_ganhador) {
                        messageDiv.innerHTML = `
                            <div style="color: #155724; padding: 20px; background: #d4edda; border-radius: 8px; font-weight: 600; text-align: center;">
                                🏆 TEMOS UM GANHADOR! 🏆<br>
                                <strong>${resultado.ganhador.nome}</strong><br>
                                Bilhete: ${resultado.ganhador.bilhete}<br>
                                Prêmio: R$ ${resultado.valor_premio}<br>
                                <small>Novo prêmio acumulado: R$ ${resultado.novo_valor_acumulado}</small>
                            </div>
                        `;
                    } else {
                        messageDiv.innerHTML = `
                            <div style="color: #856404; padding: 20px; background: #fff3cd; border-radius: 8px; font-weight: 600; text-align: center;">
                                💰 Prêmio Acumulado! 💰<br>
                                Milhar sorteada: <strong>${milhar}</strong><br>
                                Nenhum ganhador hoje<br>
                                Novo valor acumulado: <strong>R$ ${resultado.novo_valor_acumulado}</strong>
                            </div>
                        `;
                    }
                    
                    carregarStatusSorteio();
                    document.getElementById('admin-milhar-sorteada').value = '';
                    
                } else {
                    messageDiv.innerHTML = `<div style="color: #dc2626; padding: 15px; background: #fee; border-radius: 8px; font-weight: 600;">❌ ${resultado.erro}</div>`;
                    btnSortear.disabled = false;
                    btnSortear.textContent = 'REALIZAR SORTEIO';
                }
                
            } catch (error) {
                console.error('Erro ao realizar sorteio:', error);
                messageDiv.innerHTML = '<div style="color: #dc2626; padding: 15px; background: #fee; border-radius: 8px; font-weight: 600;">❌ Erro ao realizar sorteio</div>';
                btnSortear.disabled = false;
                btnSortear.textContent = 'REALIZAR SORTEIO';
            }
        }

        // FUNÇÕES ADMIN PARA AFILIADOS, SAQUES, BILHETES, ETC.
        async function carregarDadosAfiliados() {
            try {
                const response = await fetch('/admin/afiliados');
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const resultado = await response.json();
                
                // Atualizar contadores
                document.getElementById('admin-total-afiliados').textContent = resultado.afiliados?.length || 0;
                
                let totalVendas = 0;
                let totalComissoes = 0;
                let saquesPendentes = 0;
                
                resultado.afiliados?.forEach(afiliado => {
                    totalVendas += afiliado.total_vendas || 0;
                    totalComissoes += afiliado.total_comissao || 0;
                });
                
                document.getElementById('admin-vendas-afiliados').textContent = totalVendas;
                document.getElementById('admin-comissoes-pagas').textContent = `R$ ${totalComissoes.toFixed(2).replace('.', ',')}`;
                
                const container = document.getElementById('admin-lista-afiliados');
                if (resultado.afiliados && resultado.afiliados.length > 0) {
                    let html = '';
                    
                    resultado.afiliados.forEach((afiliado, index) => {
                        html += `
                            <div style="background: white; padding: 20px; border-radius: 12px; border-left: 4px solid #ff6b35; margin-bottom: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                                <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 15px; align-items: center;">
                                    <div>
                                        <strong style="color: #333; font-size: 1.1em;">${afiliado.nome}</strong><br>
                                        <small style="color: #666;">Código: ${afiliado.codigo}</small><br>
                                        <small style="color: #666;">Email: ${afiliado.email}</small><br>
                                        <small style="color: #666;">Data: ${new Date(afiliado.data_cadastro).toLocaleDateString('pt-BR')}</small>
                                        ${afiliado.chave_pix ? `<br><small style="color: #666;">PIX: ${afiliado.tipo_chave_pix || 'cpf'} - ${afiliado.chave_pix}</small>` : ''}
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="color: #007bff; font-weight: 800; font-size: 1.2em;">${afiliado.total_clicks || 0}</div>
                                        <small style="color: #666;">Cliques</small><br>
                                        <div style="color: #28a745; font-weight: 800; font-size: 1.2em;">${afiliado.total_vendas || 0}</div>
                                        <small style="color: #666;">Vendas</small>
                                    </div>
                                    <div style="text-align: right;">
                                        <div style="color: #ff6b35; font-weight: 800; font-size: 1.3em;">R$ ${(afiliado.total_comissao || 0).toFixed(2).replace('.', ',')}</div>
                                        <small style="color: #666;">Comissão Total</small><br>
                                        <div style="color: #6c757d; font-weight: 600;">R$ ${(afiliado.saldo_disponivel || 0).toFixed(2).replace('.', ',')}</div>
                                        <small style="color: #666;">Saldo</small>
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                    
                    container.innerHTML = html;
                } else {
                    container.innerHTML = '<div style="text-align: center; color: #666; padding: 50px 0;">Nenhum afiliado encontrado</div>';
                }
                
                // Carregar saques pendentes
                try {
                    const responseS = await fetch('/admin/saques/pendente');
                    if (responseS.ok) {
                        const saques = await responseS.json();
                        document.getElementById('admin-saques-pendentes').textContent = saques.saques?.length || 0;
                    }
                } catch (error) {
                    console.error('Erro ao carregar saques pendentes:', error);
                }
                
            } catch (error) {
                console.error('Erro ao carregar afiliados:', error);
                const container = document.getElementById('admin-lista-afiliados');
                container.innerHTML = '<div style="text-align: center; color: #dc2626;">Erro ao carregar dados dos afiliados</div>';
            }
        }

        async function carregarSaques(status) {
            try {
                const response = await fetch(`/admin/saques/${status}`);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const resultado = await response.json();
                
                const container = document.getElementById('admin-lista-saques');
                if (resultado.saques && resultado.saques.length > 0) {
                    // Atualizar contadores
                    const pendentes = resultado.saques.filter(s => s.status === 'solicitado').length;
                    const pagos = resultado.saques.filter(s => s.status === 'pago').length;
                    const total = resultado.saques.reduce((sum, s) => sum + s.valor, 0);
                    
                    document.getElementById('admin-saques-pendentes-total').textContent = pendentes;
                    document.getElementById('admin-saques-pagos-total').textContent = pagos;
                    document.getElementById('admin-valor-total-saques').textContent = `R$ ${total.toFixed(2).replace('.', ',')}`;
                    
                    let html = '';
                    
                    resultado.saques.forEach(saque => {
                        const statusColor = saque.status === 'solicitado' ? '#ffc107' : '#28a745';
                        const statusText = saque.status === 'solicitado' ? 'PENDENTE' : 'PAGO';
                        
                        html += `
                            <div style="background: white; padding: 20px; border-radius: 12px; border-left: 4px solid ${statusColor}; margin-bottom: 15px;">
                                <div style="display: grid; grid-template-columns: 2fr 1fr 1fr auto; gap: 15px; align-items: center;">
                                    <div>
                                        <strong style="color: #333;">${saque.afiliado_nome}</strong><br>
                                        <small style="color: #666;">PIX: ${saque.tipo_chave} - ${saque.chave_pix}</small><br>
                                        <small style="color: #666;">Código: ${saque.afiliado_codigo}</small>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="color: ${statusColor}; font-weight: 800; font-size: 1.3em;">R$ ${saque.valor.toFixed(2).replace('.', ',')}</div>
                                        <small style="color: #666;">Valor</small>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="color: #666; font-size: 0.9em;">${new Date(saque.data_solicitacao).toLocaleDateString('pt-BR')}</div>
                                        <small style="color: #666;">Data</small>
                                    </div>
                                    <div style="text-align: right;">
                                        <div style="color: ${statusColor}; font-weight: 600; font-size: 0.9em; padding: 6px 12px; background: ${statusColor}20; border-radius: 20px;">
                                            ${statusText}
                                        </div>
                                        ${saque.status === 'solicitado' ? `<button onclick="marcarSaquePago(${saque.id})" style="margin-top: 8px; padding: 4px 8px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 0.8em;">Marcar Pago</button>` : ''}
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                    
                    container.innerHTML = html;
                } else {
                    container.innerHTML = '<div style="text-align: center; color: #666; padding: 50px 0;">Nenhum saque encontrado</div>';
                }
            } catch (error) {
                console.error('Erro ao carregar saques:', error);
                const container = document.getElementById('admin-lista-saques');
                container.innerHTML = '<div style="text-align: center; color: #dc2626;">Erro ao carregar dados dos saques</div>';
            }
        }

        async function marcarSaquePago(saqueId) {
            try {
                const response = await fetch('/admin/marcar_saque_pago', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ saque_id: saqueId })
                });
                
                const resultado = await response.json();
                
                if (resultado.sucesso) {
                    carregarSaques('todos');
                    mostrarModal('<h3>Sucesso!</h3><p>Saque marcado como pago!</p>');
                } else {
                    mostrarModal(`<h3>Erro</h3><p>${resultado.erro}</p>`);
                }
                
            } catch (error) {
                console.error('Erro ao marcar saque como pago:', error);
                mostrarModal('<h3>Erro</h3><p>Erro ao marcar saque como pago</p>');
            }
        }

        async function carregarBilhetes(data) {
            try {
                const dataFiltro = data || document.getElementById('filtro-data-bilhetes').value || obterDataHoraBrasilia().toISOString().split('T')[0];
                const response = await fetch(`/admin/bilhetes/${dataFiltro}`);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const resultado = await response.json();
                
                const container = document.getElementById('admin-lista-bilhetes');
                if (resultado.bilhetes && resultado.bilhetes.length > 0) {
                    let html = '';
                    
                    resultado.bilhetes.forEach(bilhete => {
                        html += `
                            <div style="background: white; padding: 20px; border-radius: 12px; border-left: 4px solid #6f42c1; margin-bottom: 15px;">
                                <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 15px; align-items: center;">
                                    <div>
                                        <strong style="color: #333;">${bilhete.nome}</strong><br>
                                        <small style="color: #666;">Tel: ${bilhete.telefone}</small><br>
                                        <small style="color: #666;">PIX: ${bilhete.chave_pix}</small><br>
                                        <small style="color: #666;">Payment: ${bilhete.payment_id}</small>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="color: #6f42c1; font-weight: 800; font-size: 1.2em;">${bilhete.bilhetes.join(', ')}</div>
                                        <small style="color: #666;">Bilhetes</small>
                                    </div>
                                    <div style="text-align: right;">
                                        <div style="color: #666; font-size: 0.9em;">${new Date(bilhete.data_sorteio).toLocaleDateString('pt-BR')}</div>
                                        <small style="color: #666;">Data Sorteio</small>
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                    
                    container.innerHTML = html;
                } else {
                    container.innerHTML = '<div style="text-align: center; color: #666; padding: 50px 0;">Nenhum bilhete encontrado para esta data</div>';
                }
            } catch (error) {
                console.error('Erro ao carregar bilhetes:', error);
                const container = document.getElementById('admin-lista-bilhetes');
                container.innerHTML = '<div style="text-align: center; color: #dc2626;">Erro ao carregar dados dos bilhetes</div>';
            }
        }

        function carregarBilhetesHoje() {
            const hoje = obterDataHoraBrasilia().toISOString().split('T')[0];
            document.getElementById('filtro-data-bilhetes').value = hoje;
            carregarBilhetes(hoje);
        }

        async function carregarRaspadinhas(data) {
            try {
                const dataFiltro = data || document.getElementById('filtro-data-raspadinhas').value || obterDataHoraBrasilia().toISOString().split('T')[0];
                const response = await fetch(`/admin/raspadinhas/${dataFiltro}`);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const resultado = await response.json();
                
                // Atualizar contadores
                document.getElementById('admin-raspadinhas-vendidas').textContent = resultado.estatisticas?.total_vendidas || 0;
                document.getElementById('admin-raspadinhas-usadas').textContent = resultado.estatisticas?.total_usadas || 0;
                document.getElementById('admin-raspadinhas-pendentes').textContent = resultado.estatisticas?.total_pendentes || 0;
                
                const container = document.getElementById('admin-lista-raspadinhas');
                if (resultado.vendas && resultado.vendas.length > 0) {
                    let html = '';
                    
                    resultado.vendas.forEach(venda => {
                        const progressoUso = Math.round((venda.raspadinhas_usadas / venda.quantidade) * 100);
                        const corProgresso = progressoUso === 100 ? '#28a745' : progressoUso > 0 ? '#ffc107' : '#dc2626';
                        
                        html += `
                            <div style="background: white; padding: 20px; border-radius: 12px; border-left: 4px solid #00b341; margin-bottom: 15px;">
                                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 15px; align-items: center;">
                                    <div>
                                        <strong style="color: #333;">Payment: ${venda.payment_id}</strong><br>
                                        <small style="color: #666;">IP: ${venda.ip_cliente}</small><br>
                                        <small style="color: #666;">Valor: R$ ${venda.valor_total.toFixed(2).replace('.', ',')}</small>
                                        ${venda.afiliado_nome ? `<br><small style="color: #ff6b35;">Afiliado: ${venda.afiliado_nome}</small>` : ''}
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="color: #00b341; font-weight: 800; font-size: 1.3em;">${venda.quantidade}</div>
                                        <small style="color: #666;">Vendidas</small>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="color: ${corProgresso}; font-weight: 800; font-size: 1.2em;">${venda.raspadinhas_usadas}/${venda.quantidade}</div>
                                        <div style="background: #f0f0f0; border-radius: 10px; height: 8px; margin-top: 5px;">
                                            <div style="background: ${corProgresso}; height: 100%; border-radius: 10px; width: ${progressoUso}%;"></div>
                                        </div>
                                        <small style="color: #666;">${progressoUso}% usado</small>
                                    </div>
                                    <div style="text-align: right;">
                                        <div style="color: #666; font-size: 0.9em;">${new Date(venda.data_criacao).toLocaleDateString('pt-BR')}</div>
                                        <div style="color: #666; font-size: 0.8em;">${new Date(venda.data_criacao).toLocaleTimeString('pt-BR')}</div>
                                        <div style="color: ${venda.status === 'completed' ? '#28a745' : '#ffc107'}; font-weight: 600; font-size: 0.8em; margin-top: 4px;">
                                            ${venda.status === 'completed' ? 'PAGO' : 'PENDENTE'}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                    
                    container.innerHTML = html;
                } else {
                    container.innerHTML = '<div style="text-align: center; color: #666; padding: 50px 0;">Nenhuma venda encontrada para esta data</div>';
                }
            } catch (error) {
                console.error('Erro ao carregar raspadinhas:', error);
                const container = document.getElementById('admin-lista-raspadinhas');
                container.innerHTML = '<div style="text-align: center; color: #dc2626;">Erro ao carregar dados das raspadinhas</div>';
            }
        }

        function carregarRaspadinhasHoje() {
            const hoje = obterDataHoraBrasilia().toISOString().split('T')[0];
            document.getElementById('filtro-data-raspadinhas').value = hoje;
            carregarRaspadinhas(hoje);
        }

        // FUNÇÕES DE GANHADORES CORRIGIDAS
        async function carregarGanhadores(game) {
            try {
                let url = `/admin/ganhadores/${game}`;
                const dataFiltro = document.getElementById('filtro-data-ganhadores').value;
                if (dataFiltro) {
                    url += `?data=${dataFiltro}`;
                }
                
                const response = await fetch(url);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const resultado = await response.json();
                
                const container = document.getElementById('admin-lista-ganhadores');
                if (resultado.ganhadores && resultado.ganhadores.length > 0) {
                    let html = '';
                    
                    resultado.ganhadores.forEach(ganhador => {
                        const statusColor = ganhador.status === 'pago' ? '#28a745' : '#ffc107';
                        const gameColor = ganhador.jogo === 'Raspa Brasil' ? '#00b341' : '#007bff';
                        
                        html += `
                            <div style="background: white; padding: 20px; border-radius: 12px; border-left: 4px solid ${gameColor}; margin-bottom: 15px;">
                                <div style="display: grid; grid-template-columns: 2fr 1fr 1fr auto; gap: 15px; align-items: center;">
                                    <div>
                                        <strong style="color: #333;">${ganhador.nome}</strong><br>
                                        <small style="color: #666;">PIX: ${ganhador.chave_pix}</small><br>
                                        <small style="color: #666;">Jogo: ${ganhador.jogo}</small>
                                        ${ganhador.codigo ? `<br><small style="color: #666;">Código: ${ganhador.codigo}</small>` : ''}
                                        ${ganhador.bilhete_ganhador ? `<br><small style="color: #666;">Bilhete: ${ganhador.bilhete_ganhador}</small>` : ''}
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="color: ${gameColor}; font-weight: 800; font-size: 1.3em;">${ganhador.valor}</div>
                                        <small style="color: #666;">Prêmio</small>
                                    </div>
                                    <div style="text-align: center;">
                                        let dataFormatada = 'Data não disponível';

const possiveisDatatas = [
    ganhador.data_ganho, 
    ganhador.data_criacao, 
    ganhador.gb_data_criacao,
    ganhador.created_at,
    ganhador.timestamp
];

for (const dataCandidata of possiveisDatatas) {
    if (dataCandidata) {
        try {
            const data = new Date(dataCandidata);
            if (!isNaN(data.getTime())) {
                dataFormatada = data.toLocaleDateString('pt-BR', {
                    day: '2-digit',
                    month: '2-digit', 
                    year: 'numeric'
                }) + ' às ' + data.toLocaleTimeString('pt-BR', {
                    hour: '2-digit',
                    minute: '2-digit'
                });
                break; // Para no primeiro que funcionar
            }
        } catch (error) {
            console.error('Erro ao formatar data:', dataCandidata, error);
        }
    }
}

<div style="color: #666; font-size: 0.9em; line-height: 1.2;">${dataFormatada}</div>
                                        <small style="color: #666;">Data</small>
                                    </div>
                                    <div style="text-align: right;">
                                        <div style="color: ${statusColor}; font-weight: 600; font-size: 0.9em; padding: 6px 12px; background: ${statusColor}20; border-radius: 20px;">
                                            ${ganhador.status === 'pago' ? 'PAGO' : 'PENDENTE'}
                                        </div>
                                        ${ganhador.status !== 'pago' ? `<button onclick="marcarGanhadorPago(${ganhador.id})" style="margin-top: 8px; padding: 4px 8px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 0.8em;">Marcar Pago</button>` : ''}
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                    
                    container.innerHTML = html;
                } else {
                    container.innerHTML = '<div style="text-align: center; color: #666; padding: 50px 0;">Nenhum ganhador encontrado</div>';
                }
            } catch (error) {
                console.error('Erro ao carregar ganhadores:', error);
                const container = document.getElementById('admin-lista-ganhadores');
                container.innerHTML = '<div style="text-align: center; color: #dc2626;">Erro ao carregar dados dos ganhadores</div>';
            }
        }

        async function marcarGanhadorPago(ganhadorId) {
            try {
                const response = await fetch('/admin/marcar_ganhador_pago', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ ganhador_id: ganhadorId })
                });
                
                const resultado = await response.json();
                
                if (resultado.sucesso) {
                    carregarGanhadores('todos');
                    mostrarModal('<h3>Sucesso!</h3><p>Ganhador marcado como pago!</p>');
                } else {
                    mostrarModal(`<h3>Erro</h3><p>${resultado.erro}</p>`);
                }
                
            } catch (error) {
                console.error('Erro ao marcar ganhador como pago:', error);
                mostrarModal('<h3>Erro</h3><p>Erro ao marcar ganhador como pago</p>');
            }
        }

        function adicionarGanhador() {
            document.getElementById('modal-adicionar-ganhador').style.display = 'flex';
        }

        function fecharModalAdicionarGanhador() {
            document.getElementById('modal-adicionar-ganhador').style.display = 'none';
            
            // Limpar campos
            document.getElementById('novo-ganhador-nome').value = '';
            document.getElementById('novo-ganhador-valor').value = '';
            document.getElementById('novo-ganhador-pix').value = '';
            document.getElementById('novo-ganhador-bilhete').value = '';
            document.getElementById('novo-ganhador-jogo').value = 'raspa_brasil';
            toggleBilheteField();
        }

        function toggleBilheteField() {
            const jogo = document.getElementById('novo-ganhador-jogo').value;
            const grupoBilhete = document.getElementById('grupo-bilhete-ml');
            
            if (jogo === '2para1000') {
                grupoBilhete.style.display = 'block';
            } else {
                grupoBilhete.style.display = 'none';
            }
        }

        async function salvarNovoGanhador() {
    const jogo = document.getElementById('novo-ganhador-jogo').value;
    const nome = document.getElementById('novo-ganhador-nome').value.trim();
    const valor = document.getElementById('novo-ganhador-valor').value.trim();
    const chavePix = document.getElementById('novo-ganhador-pix').value.trim();
    const bilhete = document.getElementById('novo-ganhador-bilhete').value.trim();
    
    console.log('📤 DADOS DO FRONTEND:', { jogo, nome, valor, chavePix, bilhete });
    
    if (!nome || !valor || !chavePix) {
        mostrarModal('<h3>Atenção</h3><p>Preencha todos os campos obrigatórios!</p>');
        return;
    }
    
    if (jogo === '2para1000' && (!bilhete || bilhete.length !== 4)) {
        mostrarModal('<h3>Atenção</h3><p>Digite um bilhete válido (4 dígitos)!</p>');
        return;
    }
    
    // ✅ CORRIGIDO: Enviar 'milhar' ao invés de 'bilhete_ganhador'
    const dadosEnvio = {
        jogo,
        nome,
        valor,
        chave_pix: chavePix,
        tipo_chave: 'cpf'
    };
    
    // Adicionar milhar para 2para1000
    if (jogo === '2para1000') {
        dadosEnvio.milhar = bilhete;
    }
    
    console.log('📡 ENVIANDO PARA BACKEND:', dadosEnvio);
    
    try {
        const response = await fetch('/admin/adicionar_ganhador', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(dadosEnvio)
        });
        
        console.log('📥 STATUS RESPOSTA:', response.status);
        const resultado = await response.json();
        console.log('📥 RESPOSTA BACKEND:', resultado);
        
        if (resultado.sucesso) {
            fecharModalAdicionarGanhador();
            carregarGanhadores('todos');
            mostrarModal('<h3>Sucesso!</h3><p>Ganhador adicionado com sucesso!</p>');
        } else {
            mostrarModal(`<h3>Erro</h3><p>${resultado.erro}</p>`);
        }
        
    } catch (error) {
        console.error('Erro ao adicionar ganhador:', error);
        mostrarModal('<h3>Erro</h3><p>Erro ao adicionar ganhador</p>');
    }
}

        function gerarListaGanhadoresDia() {
            const hoje = obterDataHoraBrasilia().toISOString().split('T')[0];
            document.getElementById('filtro-data-ganhadores').value = hoje;
            carregarGanhadores('todos');
        }

        async function gerarListaGanhadoresPDF() {
            try {
                const dataFiltro = document.getElementById('filtro-data-ganhadores').value || obterDataHoraBrasilia().toISOString().split('T')[0];
                const response = await fetch(`/admin/ganhadores/todos?data=${dataFiltro}`);
                
                if (!response.ok) {
                    throw new Error('Erro ao buscar ganhadores');
                }
                
                const resultado = await response.json();
                
                if (!resultado.ganhadores || resultado.ganhadores.length === 0) {
                    mostrarModal('<h3>Atenção</h3><p>Nenhum ganhador encontrado para gerar PDF.</p>');
                    return;
                }
                
                // Criar PDF usando jsPDF
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                // Título
                doc.setFontSize(16);
                doc.text('GANHA BRASIL - Lista de Ganhadores', 20, 20);
                doc.setFontSize(12);
                doc.text(`Data: ${new Date(dataFiltro).toLocaleDateString('pt-BR')}`, 20, 30);
                
                let y = 50;
                
                resultado.ganhadores.forEach((ganhador, index) => {
                    if (y > 270) {
                        doc.addPage();
                        y = 20;
                    }
                    
                    doc.text(`${index + 1}. ${ganhador.nome}`, 20, y);
                    doc.text(`   Jogo: ${ganhador.jogo}`, 20, y + 7);
                    doc.text(`   Prêmio: ${ganhador.valor}`, 20, y + 14);
                    doc.text(`   PIX: ${ganhador.chave_pix}`, 20, y + 21);
                    if (ganhador.bilhete_ganhador) {
                        doc.text(`   Bilhete: ${ganhador.bilhete_ganhador}`, 20, y + 28);
                        y += 35;
                    } else {
                        y += 28;
                    }
                    
                    y += 5;
                });
                
                doc.save(`ganhadores_${dataFiltro}.pdf`);
                
            } catch (error) {
                console.error('Erro ao gerar PDF:', error);
                mostrarModal('<h3>Erro</h3><p>Erro ao gerar PDF dos ganhadores</p>');
            }
        }

        async function carregarRelatorioVendas() {
            try {
                const response = await fetch('/admin/relatorio_vendas');
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const resultado = await response.json();
                
                // Atualizar contadores
                document.getElementById('admin-vendas-rb-total').textContent = resultado.raspadinhas_vendidas || 0;
                document.getElementById('admin-vendas-ml-total').textContent = resultado.bilhetes_vendidos || 0;
                document.getElementById('admin-receita-total').textContent = `R$ ${(resultado.receita_total || 0).toFixed(2).replace('.', ',')}`;
                document.getElementById('admin-vendas-hoje-total').textContent = (resultado.vendas_hoje || 0) + (resultado.vendas_hoje_ml || 0);
                
                // Gráfico simples das vendas
                const container = document.getElementById('admin-grafico-vendas');
                if (resultado.vendas_ultimos_dias) {
                    let html = '<div style="display: flex; gap: 10px; align-items: end; height: 150px; padding: 20px;">';
                    
                    const maxVendas = Math.max(...resultado.vendas_ultimos_dias.map(v => v.total));
                    
                    resultado.vendas_ultimos_dias.forEach(dia => {
                        const altura = (dia.total / maxVendas) * 100;
                        html += `
                            <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                                <div style="background: #007bff; width: 100%; height: ${altura}%; min-height: 5px; margin-bottom: 10px; border-radius: 4px 4px 0 0;"></div>
                                <div style="font-size: 0.8em; color: #666; text-align: center;">
                                    ${new Date(dia.data).toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' })}
                                </div>
                                <div style="font-weight: 600; color: #333; text-align: center;">
                                    ${dia.total}
                                </div>
                            </div>
                        `;
                    });
                    
                    html += '</div>';
                    container.innerHTML = html;
                } else {
                    container.innerHTML = '<div style="text-align: center; color: #666; padding: 50px 0;">Dados de vendas não disponíveis</div>';
                }
                
            } catch (error) {
                console.error('Erro ao carregar relatório de vendas:', error);
                const container = document.getElementById('admin-grafico-vendas');
                container.innerHTML = '<div style="text-align: center; color: #dc2626;">Erro ao carregar relatório de vendas</div>';
            }
        }

        // Verificar parâmetro de referência na URL
        function verificarReferencia() {
            const urlParams = new URLSearchParams(window.location.search);
            const refCode = urlParams.get('ref');
            
            if (refCode) {
                localStorage.setItem('raspa_ref', refCode);
                sessionStorage.setItem('raspa_ref', refCode);
                
                // Registrar clique do afiliado
                fetch('/registrar_clique_afiliado', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ codigo: refCode })
                }).catch(error => console.error('Erro ao registrar clique:', error));
            }
        }

        // Verificar login de afiliado salvo
        function verificarLoginAfiliado() {
            const cpfSalvo = localStorage.getItem('affiliate_cpf');
            if (cpfSalvo) {
                fetch('/login_afiliado', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ cpf: cpfSalvo })
                })
                .then(response => response.json())
                .then(resultado => {
                    if (resultado.sucesso) {
                        currentAffiliate = resultado.afiliado;
                    }
                })
                .catch(error => console.error('Erro ao verificar login afiliado:', error));
            }
        }

        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            initBannerSlider();
            gerarGanhadoresSlider();
            initWinnerAlerts();
            verificarReferencia();
            verificarLogin();
            verificarLoginAfiliado();
            atualizarDisplayRB();
            atualizarDisplayML();
            
            // Limpar intervalos ao sair da página
            window.addEventListener('beforeunload', function() {
                if (paymentCheckInterval) {
                    clearInterval(paymentCheckInterval);
                }
            });
        });
    </script>
</body>
</html>
